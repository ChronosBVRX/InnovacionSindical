<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plataforma Sindical CG ‚Äî Calculadoras CCT</title>
  <style>
    :root {
      --bg: #0f172a;
      --card: #1e293b;
      --input: #334155;
      --txt: #f1f5f9;
      --muted: #94a3b8;
      --primary: #2dd4bf;
      --primary-dark: #14b8a6;
      --accent: #facc15;
      --danger: #fb7185;
      --border: rgba(255, 255, 255, 0.1);
      --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);

      --cpto-bg: rgba(45, 212, 191, 0.15);
      --cpto-danger-bg: rgba(251, 113, 133, 0.15);
      --warning-bg: rgba(250, 204, 21, 0.05);
      --warning-border: rgba(250, 204, 21, 0.3);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
    body { background: var(--bg); color: var(--txt); min-height: 100vh; padding: 20px; line-height: 1.6; }
    .container { max-width: 1000px; margin: 0 auto; }

    header { background: var(--card); padding: 24px; border-radius: 16px; border-bottom: 4px solid var(--primary); margin-bottom: 24px; box-shadow: var(--shadow); display: flex; align-items: center; gap: 15px; }
    .logo { background: var(--primary); color: #0f172a; width: 56px; height: 56px; border-radius: 12px; display: grid; place-items: center; font-weight: 900; font-size: 24px; }
    h1 { font-size: 1.5rem; font-weight: 700; color: var(--txt); }
    .subtitle { font-size: 0.95rem; color: var(--muted); margin-top: 4px;}

    .global-search { background: var(--card); padding: 24px; border-radius: 16px; box-shadow: var(--shadow); margin-bottom: 24px; border: 1px solid var(--border); }
    .global-search label { display: block; font-weight: 600; margin-bottom: 12px; font-size: 1.05rem; color: var(--primary);}
    .autocomplete-wrapper { position: relative; }
    input[type="text"], input[type="number"], select { width: 100%; padding: 14px; border: 1px solid var(--border); border-radius: 10px; font-size: 1rem; outline: none; transition: border-color 0.2s; background-color: var(--input); color: var(--txt);}
    input:focus, select:focus { border-color: var(--primary); }

    .autocomplete-items { position: absolute; border: 1px solid var(--border); border-top: none; z-index: 99; top: 100%; left: 0; right: 0; max-height: 250px; overflow-y: auto; background: var(--card); border-radius: 0 0 10px 10px; box-shadow: var(--shadow); margin-top: 4px;}
    .autocomplete-items div { padding: 14px; cursor: pointer; border-bottom: 1px solid var(--border); font-size: 0.95rem; display: flex; justify-content: space-between; align-items: center;}
    .autocomplete-items div:hover { background-color: rgba(45, 212, 191, 0.1); color: var(--txt); }

    .user-data-bar { display: none; margin-top: 20px; padding: 16px; background: rgba(0,0,0,0.2); border-radius: 10px; border-left: 4px solid var(--primary); font-size: 0.95rem; align-items: center; border: 1px solid var(--border);}
    .user-data-bar.active { display: flex; gap: 24px; flex-wrap: wrap; }
    .user-data-bar span { font-weight: 700; color: var(--txt); font-size: 1.05rem;}
    .user-data-bar .hint { font-size: 0.8rem; color: var(--muted); display: block; margin-top: 4px;}

    .layout { display: grid; grid-template-columns: 260px 1fr; gap: 24px; }
    @media (max-width: 768px) { .layout { grid-template-columns: 1fr; } }

    .menu { display: flex; flex-direction: column; gap: 8px; }
    .menu-btn { background: transparent; border: 1px solid var(--border); color: var(--muted); padding: 14px 16px; border-radius: 12px; text-align: left; cursor: pointer; transition: all 0.2s; font-size: 0.95rem; }
    .menu-btn:hover { background: rgba(255,255,255,0.05); color: var(--txt); }
    .menu-btn.active { background: var(--primary); color: #0f172a; font-weight: 700; box-shadow: 0 0 15px rgba(45, 212, 191, 0.3); border-color: var(--primary); }

    .panel { background: var(--card); border-radius: 16px; padding: 24px; box-shadow: var(--shadow); display: none; animation: fadeIn 0.3s ease; }
    .panel.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .panel h2 { color: var(--primary); margin-bottom: 12px; font-size: 1.5rem; font-weight: 700;}
    .panel p.desc { color: var(--muted); margin-bottom: 24px; font-size: 1rem; line-height: 1.5; }

    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 8px; color: var(--txt);}
    .btn-calc { width: 100%; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: #0f172a; border: none; padding: 14px; border-radius: 10px; font-size: 1.05rem; font-weight: 800; cursor: pointer; margin-top: 10px; transition: transform 0.1s; }
    .btn-calc:active { transform: scale(0.98); }

    .result-card { margin-top: 24px; background: rgba(0,0,0,0.3); border-radius: 12px; overflow: hidden; border: 1px solid var(--border); display: none; padding: 0 16px;}
    .result-card.active { display: block; }
    .result-row { display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
    .result-row:last-child { border-bottom: none; }
    .result-label { font-size: 0.95rem; color: var(--muted); }
    .result-value { font-family: monospace; font-size: 1.2rem; font-weight: 700; color: var(--txt); text-align: right;}

    .cpto-tag { background: var(--cpto-bg); color: var(--primary); padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 800; margin-left: 8px; display: inline-flex; align-items: center; border: 1px solid rgba(45, 212, 191, 0.3);}
    .cpto-tag.desc { background: var(--cpto-danger-bg); color: var(--danger); border-color: rgba(251, 113, 133, 0.3);}

    table { width: 100%; border-collapse: collapse; margin-top: 16px; font-size: 0.95rem; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border); }
    th { background: rgba(255,255,255,0.05); font-weight: 600; color: var(--txt); }

    .legal-basis { background: rgba(255,255,255,0.03); color: var(--muted); font-size: 0.85rem; padding: 12px 16px; border-radius: 8px; margin-top: 24px; border-left: 3px solid var(--input); }
    .legal-basis strong { color: var(--txt); }

    .disclaimer-box { background: var(--warning-bg); border: 1px solid var(--warning-border); border-left: 4px solid var(--accent); padding: 16px; border-radius: 8px; margin-top: 24px; }
    .disclaimer-box p { color: #fde047; font-size: 0.9rem; margin: 0; line-height: 1.5; }
    .disclaimer-box strong { color: var(--accent); }

  </style>
</head>
<body>

<div class="container">
  <header>
    <div class="logo">CG</div>
    <div>
      <h1>Calculadoras de Prestaciones SNTSS</h1>
      <div class="subtitle">Herramientas basadas en tu CCT. F√°ciles, r√°pidas y transparentes.</div>
    </div>
  </header>

  <div class="global-search">
    <label for="buscador">üëã ¬°Hola! Para empezar, selecciona tu categor√≠a:</label>
    <div class="autocomplete-wrapper">
      <input type="text" id="buscador" placeholder="Escribe aqu√≠ tu puesto (Ej. Enfermera General, Medico, Auxiliar...)" autocomplete="off">
    </div>

    <div id="user-data" class="user-data-bar">
      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Categor√≠a</span><br>
        <span id="ud-cat">-</span>
      </div>
      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Jornada</span><br>
        <span id="ud-jor">-</span> <span style="font-size:0.85rem; font-weight:normal;">hrs</span>
      </div>
      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Tabular (Cpto 02) <b>Quincenal</b></span><br>
        <span id="ud-tab" style="color:var(--primary);">$0.00</span>
        <span class="hint">Referencia mensual estimada: <span id="ud-tab-m">$0.00</span></span>
      </div>

      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Ayuda de Renta (Cpto 011) <b>Quincenal</b></span><br>
        <div style="display:flex; align-items:center;">
          <span style="font-weight:normal; margin-right:4px;">$</span>
          <input type="number" id="ud-renta" value="0" style="width: 120px; padding: 8px; font-weight: bold; font-family:monospace; font-size:1.1rem; background: var(--bg); border: 1px solid var(--border);" onchange="updateRentaGlobal()">
        </div>
        <span class="hint">D√©jalo tal cual tu tarjet√≥n (var√≠a por factores que no siempre se capturan aqu√≠). Ref. mensual: <span id="ud-renta-m">$0.00</span></span>
      </div>

      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Sueldo Base (02+011) <b>Mensual</b></span><br>
        <span id="ud-sueldo-m" style="color:var(--txt);">$0.00</span>
        <span class="hint">Se usa internamente para c√°lculos por ‚Äúmes‚Äù.</span>
      </div>
    </div>
  </div>

  <div class="layout">
    <nav class="menu">
      <button class="menu-btn active" onclick="openPanel('p-anticipo', this)">Anticipo de Sueldo</button>
      <button class="menu-btn" onclick="openPanel('p-ahorro', this)">Fondo de Ahorro (Julio)</button>
      <button class="menu-btn" onclick="openPanel('p-extra', this)">Tiempo Extra</button>
      <button class="menu-btn" onclick="openPanel('p-hipo-largo', this)">Hipotecario Largo (30 a√±os)</button>
      <button class="menu-btn" onclick="openPanel('p-hipo-medio', this)">Hipotecario Medio (12 a√±os)</button>
      <button class="menu-btn" onclick="openPanel('p-auto', this)">Cr√©dito para Auto</button>
      <button class="menu-btn" onclick="openPanel('p-aguinaldo', this)">Aguinaldo y Anticipos</button>
    </nav>

    <main>

      <div id="p-anticipo" class="panel active">
        <h2>Anticipo de Sueldo</h2>
        <p class="desc">Descubre cu√°nto puedes pedir de adelanto de tu sueldo para salir de un apuro y en cu√°nto te quedar√° el descuento a la quincena. ¬°Cero intereses!</p>

        <div class="form-group">
          <label>¬øCu√°ntos meses necesitas que te adelanten?</label>
          <select id="ant_meses">
            <option value="1">1 Mes (P√°galo en 10 quincenas)</option>
            <option value="2">2 Meses (P√°galo en 20 quincenas)</option>
            <option value="3">3 Meses (P√°galo en 30 quincenas)</option>
            <option value="4">4 Meses (P√°galo en 40 quincenas)</option>
          </select>
        </div>
        <button class="btn-calc" onclick="calcAnticipo()">Ver mi adelanto</button>

        <div id="res_anticipo" class="result-card">
          <div class="result-row">
            <span class="result-label">Te depositar√≠an m√°ximo:</span>
            <span class="result-value" id="ant_monto" style="color: var(--primary);">$0.00</span>
          </div>
          <div class="result-row">
            <span class="result-label">Terminar√≠as de pagarlo en:</span>
            <span class="result-value" id="ant_plazo">0 Quincenas</span>
          </div>
          <div class="result-row">
            <span class="result-label">Tu descuento quincenal fijo ser√≠a: <span class="cpto-tag desc">Deducci√≥n Temporal</span></span>
            <span class="result-value" style="color: var(--danger);" id="ant_desc">-$0.00</span>
          </div>
        </div>

        <div class="legal-basis">
          üìñ <strong>Fundamento:</strong> Cl√°usula 97 del Contrato Colectivo de Trabajo (CCT).
        </div>
      </div>

      <div id="p-ahorro" class="panel">
        <h2>Fondo de Ahorro (La 2da de Julio)</h2>
        <p class="desc">Calcula ese guardadito anual que cae como anillo al dedo en la segunda quincena de julio.</p>

        <div class="form-group">
          <label>¬øCu√°ntos d√≠as laboraste en el √∫ltimo a√±o? (De julio a julio)</label>
          <input type="number" id="aho_dias" value="365" max="365">
          <p style="font-size: 0.8rem; color: var(--muted); margin-top: 6px;">Por lo general son los 365 d√≠as. Solo b√°jale si tuviste faltas o licencias sin goce de sueldo.</p>
        </div>
        <button class="btn-calc" onclick="calcAhorro()">Calcular mi fondo</button>

        <div id="res_ahorro" class="result-card">
          <div class="result-row">
            <span class="result-label">D√≠as proporcionales que lograste generar:</span>
            <span class="result-value" id="aho_dias_res">0 d√≠as</span>
          </div>
          <div class="result-row" style="background: rgba(45, 212, 191, 0.1);">
            <span class="result-label" style="color: var(--primary); font-weight: 700;">Total a recibir (Libre de impuestos): <span class="cpto-tag" style="background: var(--primary); color: #000;">Concepto 055</span></span>
            <span class="result-value" id="aho_total" style="color: var(--primary); font-size: 1.5rem;">$0.00</span>
          </div>
        </div>

        <div class="legal-basis">
          üìñ <strong>Fundamento:</strong> Cl√°usula 144 del CCT.
        </div>
      </div>

      <div id="p-extra" class="panel">
        <h2>Pago de Tiempo Extra</h2>
        <p class="desc">Conoce exactamente cu√°nto te pagar√°n por esas horas adicionales que te quedaste apoyando en tu servicio.</p>

        <div class="form-group">
          <label>¬øCu√°ntas horas extra laboraste en la quincena?</label>
          <input type="number" id="ext_horas" placeholder="Ej. 4">
        </div>
        <div class="form-group">
          <label>¬øC√≥mo te las van a pagar?</label>
          <select id="ext_factor">
            <option value="2">Al Doble (x2) - Si hiciste hasta 9 horas en la semana</option>
            <option value="3">Al Triple (x3) - M√°s de 9 horas o si trabajaste en tu descanso</option>
            <option value="4">Al Cu√°druple (x4) - Si trabajaste en d√≠a festivo obligatorio y adem√°s era tu descanso</option>
          </select>
        </div>
        <button class="btn-calc" onclick="calcExtra()">Calcular mis horas</button>

        <div id="res_extra" class="result-card">
          <div class="result-row">
            <span class="result-label">Tu hora de sueldo base vale:</span>
            <span class="result-value" id="ext_base" style="font-size: 1rem; color: var(--muted);">$0.00</span>
          </div>
          <div class="result-row">
            <span class="result-label" style="font-weight: 700;">Total a recibir en efectivo: <span class="cpto-tag">Concepto 037</span></span>
            <span class="result-value" id="ext_total" style="color: var(--primary);">$0.00</span>
          </div>
        </div>

        <div class="legal-basis">
          üìñ <strong>Fundamento:</strong> Cl√°usulas 32 y 33 del CCT, y Normativa de Conceptos de Pago (Cpto 037).
        </div>
      </div>

      <div id="p-hipo-largo" class="panel">
        <h2>Cr√©dito Hipotecario a Largo Plazo</h2>
        <p class="desc">Mira cu√°nto te presta el Instituto para comprar, construir o reparar tu casa, y en cu√°nto te quedar√≠a el descuento a 30 a√±os.</p>

        <div class="form-group">
          <label>¬øQu√© tan libre de deudas est√° tu tarjet√≥n de pago?</label>
          <select id="hl_liq">
            <option value="90">Mi tarjet√≥n est√° limpio y tengo buena capacidad</option>
            <option value="75">Tengo algunos descuentos o pr√©stamos activos</option>
          </select>
        </div>
        <button class="btn-calc" onclick="calcHipoLargo()">Simular mi Cr√©dito a 30 a√±os</button>

        <div id="res_hipo_largo" class="result-card">
          <div class="result-row">
            <span class="result-label">Tu Monto M√°ximo Ideal ser√≠a:</span>
            <span class="result-value" id="hl_max" style="color: var(--primary);">$0.00</span>
          </div>
          <div class="result-row">
            <span class="result-label">Tu descuento quincenal (Fijo por 30 a√±os): <span class="cpto-tag desc">Concepto 130</span></span>
            <span class="result-value" style="color: var(--danger);" id="hl_desc">-$0.00</span>
          </div>
        </div>

        <div class="disclaimer-box">
          <p>üí° <strong>Nota sobre tu Liquidez:</strong> Los montos mostrados son el m√°ximo ideal al que tienes derecho. Para que el IMSS te autorice estas cantidades exactas, revisar√°n tu Tarjet√≥n de Pago para asegurarse de que, despu√©s de cobrarte este nuevo pr√©stamo, te siga quedando dinero suficiente para tus gastos b√°sicos (al menos 15 d√≠as de salario m√≠nimo libre). Si tienes muchos descuentos, podr√≠an pedirte que liquides los menores antes.</p>
        </div>

        <div class="legal-basis">
          üìñ <strong>Fundamento:</strong> Cl√°usula 81 del CCT y Art√≠culos 4 y 6 del Reglamento de Pr√©stamos para el Fomento de la Habitaci√≥n.
        </div>
      </div>

      <div id="p-hipo-medio" class="panel">
        <h2>Cr√©dito Hipotecario a Mediano Plazo</h2>
        <p class="desc">Una excelente opci√≥n si quieres un pr√©stamo para tu vivienda que liquides mucho m√°s r√°pido (m√°ximo en 12 a√±os).</p>

        <button class="btn-calc" onclick="calcHipoMedio()">Simular mi Cr√©dito a 12 a√±os</button>

        <div id="res_hipo_medio" class="result-card">
          <div class="result-row">
            <span class="result-label">Tu Monto M√°ximo Ideal (35 meses):</span>
            <span class="result-value" id="hm_max" style="color: var(--primary);">$0.00</span>
          </div>
          <div class="result-row">
            <span class="result-label">Tu descuento quincenal (Fijo por 12 a√±os): <span class="cpto-tag desc">Concepto 136</span></span>
            <span class="result-value" style="color: var(--danger);" id="hm_desc">-$0.00</span>
          </div>
        </div>

        <div class="disclaimer-box">
          <p>üí° <strong>Nota sobre tu Liquidez:</strong> Los montos mostrados son el m√°ximo ideal al que tienes derecho. Para que el IMSS te autorice estas cantidades exactas, revisar√°n tu Tarjet√≥n de Pago para asegurarse de que, despu√©s de cobrarte este nuevo pr√©stamo, te siga quedando dinero suficiente para tus gastos b√°sicos (al menos 15 d√≠as de salario m√≠nimo libre). Si tienes muchos descuentos, podr√≠an pedirte que liquides los menores antes.</p>
        </div>

        <div class="legal-basis">
          üìñ <strong>Fundamento:</strong> Cl√°usula 81 del CCT y Art√≠culos 25 y 27 del Reglamento de Pr√©stamos para el Fomento de la Habitaci√≥n.
        </div>
      </div>

      <div id="p-auto" class="panel">
        <h2>Cr√©dito de Autom√≥vil</h2>
        <p class="desc">Descubre de cu√°nto es tu cr√©dito para estrenar auto, pag√°ndolo c√≥modamente en 5 a√±os (120 quincenas).</p>

        <button class="btn-calc" onclick="calcAuto()">Simular mi Cr√©dito Automotriz</button>

        <div id="res_auto" class="result-card">
          <div class="result-row" style="background: rgba(45, 212, 191, 0.1); padding: 16px; border-bottom: none;">
            <span class="result-label" style="font-weight: 700; color: var(--txt);">Monto M√°ximo Ideal para tu auto:</span>
            <span class="result-value" id="au_max" style="color: var(--primary); font-size: 1.5rem;">$0.00</span>
          </div>
          <div style="padding: 16px;">
            <p style="font-size: 0.95rem; color: var(--muted); margin-bottom: 8px;">As√≠ ir√≠a bajando tu descuento por a√±o: <span class="cpto-tag desc">Concepto 134</span></p>
            <table>
              <tr><th>A√±o de pago</th><th style="text-align: right;">Descuento Quincenal</th></tr>
              <tr><td>A√±o 1</td><td id="au_y1" style="color: var(--danger); font-weight: bold; text-align: right; font-family: monospace;">$0.00</td></tr>
              <tr><td>A√±o 2</td><td id="au_y2" style="color: var(--danger); font-weight: bold; text-align: right; font-family: monospace;">$0.00</td></tr>
              <tr><td>A√±o 3</td><td id="au_y3" style="color: var(--danger); font-weight: bold; text-align: right; font-family: monospace;">$0.00</td></tr>
              <tr><td>A√±o 4</td><td id="au_y4" style="color: var(--danger); font-weight: bold; text-align: right; font-family: monospace;">$0.00</td></tr>
              <tr><td>A√±o 5</td><td id="au_y5" style="color: var(--danger); font-weight: bold; text-align: right; font-family: monospace;">$0.00</td></tr>
            </table>
          </div>
        </div>

        <div class="disclaimer-box">
          <p>üí° <strong>Nota sobre tu Liquidez:</strong> Los montos mostrados son el m√°ximo ideal al que tienes derecho. Para que el IMSS te autorice estas cantidades exactas, revisar√°n tu Tarjet√≥n de Pago para asegurarse de que, despu√©s de cobrarte este nuevo pr√©stamo, te siga quedando dinero suficiente para tus gastos b√°sicos (al menos 15 d√≠as de salario m√≠nimo libre). Si tienes muchos descuentos, podr√≠an pedirte que liquides los menores antes.</p>
        </div>

        <div class="legal-basis">
          üìñ <strong>Fundamento:</strong> Cl√°usula 146 del CCT.
        </div>
      </div>

      <div id="p-aguinaldo" class="panel">
        <h2>Aguinaldo y Anticipos</h2>
        <p class="desc">El aguinaldo total equivale a 3 meses de sueldo. Conoce tus adelantos y el saldo libre de impuestos que recibir√°s en diciembre.</p>

        <div class="form-group">
          <label>¬øPediste que te adelantaran un mes de aguinaldo en Agosto?</label>
          <select id="ag_agosto">
            <option value="no">No, prefer√≠ esperarme</option>
            <option value="si">S√≠, ped√≠ mi mes de anticipo</option>
          </select>
        </div>
        <button class="btn-calc" onclick="calcAguinaldo()">Calcular mi Aguinaldo</button>

        <div id="res_aguinaldo" class="result-card">
          <div class="result-row" style="background: rgba(255,255,255,0.03); padding: 12px 16px; margin-bottom: 8px;">
            <span class="result-label" style="font-weight: 700; color: var(--txt);">Tus 3 meses completos valen:</span>
            <span class="result-value" id="ag_total" style="color: var(--muted); font-size:1.1rem;">$0.00</span>
          </div>
          <div class="result-row" style="padding: 12px 16px;">
            <span class="result-label">Lo que te adelantaron en Enero: <span class="cpto-tag">Cpto 047</span></span>
            <span class="result-value" id="ag_enero" style="color: var(--muted); font-size:1.1rem;">$0.00</span>
          </div>
          <div class="result-row" id="row_agosto" style="display: none; padding: 12px 16px;">
            <span class="result-label">Lo que te adelantaron en Agosto:</span>
            <span class="result-value" id="ag_ago_val" style="color: var(--muted); font-size:1.1rem;">$0.00</span>
          </div>
          <div class="result-row" style="background: rgba(45, 212, 191, 0.1); padding: 16px;">
            <span class="result-label" style="color: var(--primary); font-weight: 800;">Saldo a recibir en Diciembre: <span class="cpto-tag" style="background: var(--primary); color: #000;">Cpto 049</span></span>
            <span class="result-value" id="ag_dic" style="color: var(--primary); font-size: 1.5rem;">$0.00</span>
          </div>
        </div>

        <div class="legal-basis">
          üìñ <strong>Fundamento:</strong> Cl√°usula 107 del CCT.
        </div>
      </div>

    </main>
  </div>
</div>

<script>
  // -------------------------------------------------------------
  // UTILIDADES Y VARIABLES
  // -------------------------------------------------------------
  const money = n => n.toLocaleString('es-MX', {style:'currency', currency:'MXN'});
  const removeAccents = (str) => str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");

  // OJO: tabular y renta se capturan como QUINCENALES (tarjet√≥n)
  let userData = {
    tabularQ: 0,   // Concepto 02 (quincenal)
    rentaQ: 0,     // Concepto 011 (quincenal, editable)
    jornada: 8,
    categoria: ''
  };

  // Helpers derivados para c√°lculos por ‚Äúmes‚Äù
  const sueldoBaseQ = () => (userData.tabularQ + userData.rentaQ);
  const sueldoBaseM = () => sueldoBaseQ() * 2; // conversi√≥n quincenal -> mensual
  const tabularM = () => userData.tabularQ * 2;
  const rentaM = () => userData.rentaQ * 2;

  function refreshUserBar() {
    document.getElementById('ud-tab').innerText = money(userData.tabularQ);
    document.getElementById('ud-tab-m').innerText = money(tabularM());
    document.getElementById('ud-renta-m').innerText = money(rentaM());
    document.getElementById('ud-sueldo-m').innerText = money(sueldoBaseM());
  }

  // -------------------------------------------------------------
  // BASE DE DATOS COMPLETA 
  // -------------------------------------------------------------
  const sueldosDB = [{"cat":"Pasante de Abogado","jor":"6.5","sm":5097.96},{"cat":"Abogado","jor":"6.5","sm":9125.04},{"cat":"Abogado","jor":"8.0","sm":11230.64},{"cat":"Auxiliar T√©cnico de Actuariado Social","jor":"6.5","sm":7553.14},{"cat":"Oficial T√©cnico de Actuariado Social","jor":"6.5","sm":8345.36},{"cat":"T√©cnico de Actuariado Social","jor":"6.5","sm":8932.24},{"cat":"Actuario Social Matem√°tico","jor":"6.5","sm":9581.5},{"cat":"Auxiliar de Servicios Administrativos","jor":"6.5","sm":3302.5},{"cat":"Auxiliar de Servicios Administrativos","jor":"8.0","sm":4064.76},{"cat":"Ayudante de Cajero B","jor":"8.0","sm":5022.12},{"cat":"Ayudante de Cajero A","jor":"8.0","sm":5330.68},{"cat":"Cajero D","jor":"6.5","sm":5351.94},{"cat":"Cajero D","jor":"8.0","sm":6587.36},{"cat":"Cajero C","jor":"8.0","sm":6999.44},{"cat":"Cajero B","jor":"6.5","sm":6084.36},{"cat":"Cajero A","jor":"8.0","sm":7656.68},{"cat":"Contador","jor":"6.5","sm":9125.04},{"cat":"Contador","jor":"8.0","sm":11230.64},{"cat":"Contador Auditor","jor":"6.5","sm":9125.04},{"cat":"Contador Auditor","jor":"8.0","sm":11230.64},{"cat":"Pasante de Economista","jor":"8.0","sm":5876.44},{"cat":"Economista","jor":"6.5","sm":9125.04},{"cat":"Economista","jor":"8.0","sm":11230.64},{"cat":"Soci√≥logo","jor":"6.5","sm":9125.04},{"cat":"Redactor B","jor":"6.5","sm":4583.28},{"cat":"Mensajero","jor":"6.5","sm":3955.4},{"cat":"Mensajero","jor":"8.0","sm":4868.04}
  /* ... TU DB COMPLETA CONTIN√öA AQU√ç EXACTAMENTE IGUAL ...
     (La recort√© en esta vista para no hacer interminable el scroll)
     Pega aqu√≠ toda tu DB completa como la tra√≠as originalmente. */
  ];

  // -------------------------------------------------------------
  // BUSCADOR Y AUTOCOMPLETE A PRUEBA DE ACENTOS
  // -------------------------------------------------------------
  const searchInput = document.getElementById('buscador');
  searchInput.addEventListener('input', function() {
    closeLists();
    if (!this.value) return;

    let a = document.createElement("DIV");
    a.setAttribute("class", "autocomplete-items");
    this.parentNode.appendChild(a);

    let searchVal = removeAccents(this.value.toLowerCase());

    let matches = sueldosDB.filter(i => {
      let catNorm = removeAccents((i.cat || '').toLowerCase());
      return catNorm.includes(searchVal);
    }).slice(0, 15);

    matches.forEach(item => {
      let b = document.createElement("DIV");
      b.innerHTML = `
        <div>
          <strong>${item.cat}</strong>
          <span style="color:var(--muted); font-size:0.85rem;">(${item.jor} hrs)</span>
        </div>
        <div style="color:var(--primary); font-weight:bold;">
          ${money(item.sm)} <span style="color:var(--muted); font-weight:600; font-size:0.75rem;">quincenal</span>
        </div>`;
      b.addEventListener("click", function() {
        seleccionarPuesto(item);
        closeLists();
      });
      a.appendChild(b);
    });
  });

  function closeLists() {
    let x = document.getElementsByClassName("autocomplete-items");
    for (let i = 0; i < x.length; i++) x[i].parentNode.removeChild(x[i]);
  }
  document.addEventListener("click", e => closeLists());

  // -------------------------------------------------------------
  // LLENADO DE DATOS Y VALIDACI√ìN
  // -------------------------------------------------------------
  function seleccionarPuesto(item) {
    searchInput.value = `${item.cat} (${item.jor} hrs)`;
    userData.tabularQ = Number(item.sm) || 0;     // QUINCENAL
    userData.jornada = parseFloat(item.jor) || 8; // hrs
    userData.categoria = item.cat || '';

    updateRentaGlobal(); // respeta lo que el usuario tenga capturado

    document.getElementById('ud-cat').innerText = userData.categoria;
    document.getElementById('ud-jor').innerText = item.jor || '-';

    refreshUserBar();
    document.getElementById('user-data').classList.add('active');
  }

  // Validaci√≥n de seguridad para Ayuda de Renta (QUINCENAL)
  function updateRentaGlobal() {
    let inputRenta = document.getElementById('ud-renta');
    let val = parseFloat(inputRenta.value);

    if (isNaN(val) || val < 0) {
      alert("¬°Cuidado! El monto de la Ayuda de Renta (Cpto 011) no parece v√°lido. Usa solo n√∫meros (ej. 500 o 1200.50).");
      inputRenta.value = 0;
      userData.rentaQ = 0;
    } else if (val > 15000) {
      alert("Ese monto parece demasiado alto para el Concepto 011 (quincenal). Verifica tu tarjet√≥n. Si est√°s seguro, lo puedes dejar as√≠.");
      userData.rentaQ = val;
    } else {
      userData.rentaQ = val;
    }
    refreshUserBar();
  }

  // -------------------------------------------------------------
  // NAVEGACI√ìN
  // -------------------------------------------------------------
  function openPanel(panelId, btn) {
    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(panelId).classList.add('active');
    btn.classList.add('active');
  }

  function validarDatos() {
    if (userData.tabularQ === 0) {
      alert("¬°Hola! Por favor busca y selecciona primero tu categor√≠a en el buscador de arriba.");
      searchInput.focus();
      return false;
    }
    return true;
  }

  // -------------------------------------------------------------
  // 1. ANTICIPO
  // Regla: Sueldo = (02 + 011) pero como el tarjet√≥n lo trae QUINCENAL,
  // lo convertimos a mensual para multiplicar por ‚Äúmeses‚Äù.
  // -------------------------------------------------------------
  function calcAnticipo() {
    if (!validarDatos()) return;

    const sueldoM = sueldoBaseM(); // mensual
    const meses = parseInt(document.getElementById('ant_meses').value);

    const monto = sueldoM * meses;
    const plazo = meses * 10;
    const desc = monto / plazo;

    document.getElementById('ant_monto').innerText = money(monto);
    document.getElementById('ant_plazo').innerText = plazo + " Quincenas";
    document.getElementById('ant_desc').innerText = "-" + money(desc);
    document.getElementById('res_anticipo').classList.add('active');
  }

  // -------------------------------------------------------------
  // 2. FONDO AHORRO
  // Salario diario = Tabular (02) / 30
  // Como 02 es QUINCENAL, usamos TabularMensual/30
  // -------------------------------------------------------------
  function calcAhorro() {
    if (!validarDatos()) return;

    const diasLab = parseFloat(document.getElementById('aho_dias').value) || 0;

    const salarioDiario = tabularM() / 30;
    const diasPagar = 46 * (diasLab / 365);
    const total = salarioDiario * diasPagar;

    document.getElementById('aho_dias_res').innerText = diasPagar.toFixed(2) + " d√≠as";
    document.getElementById('aho_total').innerText = money(total);
    document.getElementById('res_ahorro').classList.add('active');
  }

  // -------------------------------------------------------------
  // 3. TIEMPO EXTRA
  // Costo por hora = (02+011) / 30 / jornada
  // Como (02+011) viene QUINCENAL, usamos sueldoMensual/30
  // -------------------------------------------------------------
  function calcExtra() {
    if (!validarDatos()) return;

    const horas = parseFloat(document.getElementById('ext_horas').value) || 0;
    const factor = parseInt(document.getElementById('ext_factor').value);

    const costoHora = sueldoBaseM() / 30 / userData.jornada;
    const total = costoHora * factor * horas;

    document.getElementById('ext_base').innerText = money(costoHora);
    document.getElementById('ext_total').innerText = money(total);
    document.getElementById('res_extra').classList.add('active');
  }

  // -------------------------------------------------------------
  // REGLA HIPOTECARIA Y AUTO (porcentaje por categor√≠a)
  // Umbral: Mensajero 8.0hrs = $4868.04 (TABULAR QUINCENAL)
  // -------------------------------------------------------------
  function getPorcentajeHipotecario() {
    return userData.tabularQ <= 4868.04 ? 0.25 : 0.30;
  }

  // -------------------------------------------------------------
  // 4. HIPOTECARIO LARGO
  // SMI = SueldoMensual * 1.20
  // Monto max = SMI * (75 o 90)
  // Desc quincenal = (SMI * %)/2
  // -------------------------------------------------------------
  function calcHipoLargo() {
    if (!validarDatos()) return;

    const liq = parseInt(document.getElementById('hl_liq').value);

    const smi = sueldoBaseM() * 1.20;
    const max = smi * liq;
    const porcentaje = getPorcentajeHipotecario();
    const desc = (smi * porcentaje) / 2;

    document.getElementById('hl_max').innerText = money(max);
    document.getElementById('hl_desc').innerText = "-" + money(desc);
    document.getElementById('res_hipo_largo').classList.add('active');
  }

  // -------------------------------------------------------------
  // 5. HIPOTECARIO MEDIO
  // SMI = SueldoMensual * 1.20
  // Monto max = SMI * 35
  // Desc quincenal = (SMI * %)/2
  // -------------------------------------------------------------
  function calcHipoMedio() {
    if (!validarDatos()) return;

    const smi = sueldoBaseM() * 1.20;
    const max = smi * 35;
    const porcentaje = getPorcentajeHipotecario();
    const desc = (smi * porcentaje) / 2;

    document.getElementById('hm_max').innerText = money(max);
    document.getElementById('hm_desc').innerText = "-" + money(desc);
    document.getElementById('res_hipo_medio').classList.add('active');
  }

  // -------------------------------------------------------------
  // 6. AUTO
  // SMI = SueldoMensual * 1.20
  // Monto max = SMI * 24
  // Descuentos por a√±o: (SMI * factor)/2
  // -------------------------------------------------------------
  function calcAuto() {
    if (!validarDatos()) return;

    const smi = sueldoBaseM() * 1.20;
    const max = smi * 24;

    document.getElementById('au_max').innerText = money(max);
    document.getElementById('au_y1').innerText = "-" + money((smi * 0.40) / 2);
    document.getElementById('au_y2').innerText = "-" + money((smi * 0.39) / 2);
    document.getElementById('au_y3').innerText = "-" + money((smi * 0.38) / 2);
    document.getElementById('au_y4').innerText = "-" + money((smi * 0.37) / 2);
    document.getElementById('au_y5').innerText = "-" + money((smi * 0.36) / 2);

    document.getElementById('res_auto').classList.add('active');
  }

  // -------------------------------------------------------------
  // 7. AGUINALDO
  // Base sueldo = (02+011) mensual (porque ‚Äú3 meses‚Äù)
  // Total = sueldoM * 3
  // Enero = sueldoM * 0.5
  // Agosto = sueldoM * 1 (si aplica)
  // Dic = Total - Enero - Agosto
  // -------------------------------------------------------------
  function calcAguinaldo() {
    if (!validarDatos()) return;

    const pideAgosto = document.getElementById('ag_agosto').value === 'si';

    const sueldoM = sueldoBaseM();
    const total = sueldoM * 3;
    const enero = sueldoM * 0.5;
    const agosto = pideAgosto ? (sueldoM * 1) : 0;
    const dic = total - enero - agosto;

    document.getElementById('ag_total').innerText = money(total);
    document.getElementById('ag_enero').innerText = money(enero);

    if (pideAgosto) {
      document.getElementById('row_agosto').style.display = 'flex';
      document.getElementById('ag_ago_val').innerText = money(agosto);
    } else {
      document.getElementById('row_agosto').style.display = 'none';
    }

    document.getElementById('ag_dic').innerText = money(dic);
    document.getElementById('res_aguinaldo').classList.add('active');
  }
</script>
</body>
</html>
