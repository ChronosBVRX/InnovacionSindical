<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plataforma Sindical CG ‚Äî Calculadoras CCT</title>
  <style>
    :root{
      --bg:#0f172a;
      --card:#1e293b;
      --input:#334155;
      --txt:#f1f5f9;
      --muted:#94a3b8;
      --primary:#2dd4bf;
      --primary-dark:#14b8a6;
      --accent:#facc15;
      --danger:#fb7185;
      --border:rgba(255,255,255,.1);
      --shadow:0 10px 15px -3px rgba(0,0,0,.5);

      --cpto-bg:rgba(45,212,191,.15);
      --cpto-danger-bg:rgba(251,113,133,.15);
      --warning-bg:rgba(250,204,21,.05);
      --warning-border:rgba(250,204,21,.3);
      --info-bg:rgba(255,255,255,.03);
      --info-border:rgba(255,255,255,.08);
    }

    *{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}
    body{background:var(--bg);color:var(--txt);min-height:100vh;padding:20px;line-height:1.6}
    .container{max-width:1000px;margin:0 auto}

    header{
      background:var(--card);padding:24px;border-radius:16px;border-bottom:4px solid var(--primary);
      margin-bottom:24px;box-shadow:var(--shadow);display:flex;align-items:center;gap:15px
    }
    .logo{background:var(--primary);color:#0f172a;width:56px;height:56px;border-radius:12px;display:grid;place-items:center;font-weight:900;font-size:24px}
    h1{font-size:1.5rem;font-weight:700;color:var(--txt)}
    .subtitle{font-size:.95rem;color:var(--muted);margin-top:4px}

    .global-search{
      background:var(--card);padding:24px;border-radius:16px;box-shadow:var(--shadow);
      margin-bottom:24px;border:1px solid var(--border)
    }
    .global-search label{display:block;font-weight:600;margin-bottom:12px;font-size:1.05rem;color:var(--primary)}
    .autocomplete-wrapper{position:relative}

    input[type="text"],input[type="number"],select{
      width:100%;padding:14px;border:1px solid var(--border);border-radius:10px;font-size:1rem;
      outline:none;transition:border-color .2s;background-color:var(--input);color:var(--txt)
    }
    input:focus,select:focus{border-color:var(--primary)}

    .autocomplete-items{
      position:absolute;border:1px solid var(--border);border-top:none;z-index:99;top:100%;left:0;right:0;
      max-height:250px;overflow-y:auto;background:var(--card);border-radius:0 0 10px 10px;
      box-shadow:var(--shadow);margin-top:4px
    }
    .autocomplete-items div{
      padding:14px;cursor:pointer;border-bottom:1px solid var(--border);font-size:.95rem;
      display:flex;justify-content:space-between;align-items:center;gap:12px
    }
    .autocomplete-items div:hover{background-color:rgba(45,212,191,.1);color:var(--txt)}

    .user-data-bar{
      display:none;margin-top:20px;padding:16px;background:rgba(0,0,0,.2);border-radius:10px;
      border-left:4px solid var(--primary);font-size:.95rem;align-items:flex-start;border:1px solid var(--border)
    }
    .user-data-bar.active{display:flex;gap:24px;flex-wrap:wrap}
    .user-data-bar span{font-weight:700;color:var(--txt);font-size:1.05rem}
    .user-data-bar .hint{font-size:.8rem;color:var(--muted);display:block;margin-top:4px;max-width:320px}

    .layout{display:grid;grid-template-columns:260px 1fr;gap:24px}
    @media (max-width:768px){.layout{grid-template-columns:1fr}}

    .menu{display:flex;flex-direction:column;gap:8px}
    .menu-btn{
      background:transparent;border:1px solid var(--border);color:var(--muted);padding:14px 16px;border-radius:12px;
      text-align:left;cursor:pointer;transition:all .2s;font-size:.95rem
    }
    .menu-btn:hover{background:rgba(255,255,255,.05);color:var(--txt)}
    .menu-btn.active{
      background:var(--primary);color:#0f172a;font-weight:700;box-shadow:0 0 15px rgba(45,212,191,.3);
      border-color:var(--primary)
    }

    .panel{background:var(--card);border-radius:16px;padding:24px;box-shadow:var(--shadow);display:none;animation:fadeIn .25s ease}
    .panel.active{display:block}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    .panel h2{color:var(--primary);margin-bottom:10px;font-size:1.5rem;font-weight:700}
    .panel p.desc{color:var(--muted);margin-bottom:22px;font-size:1rem;line-height:1.5}

    .form-group{margin-bottom:18px}
    .form-group label{display:block;font-size:.9rem;font-weight:600;margin-bottom:8px;color:var(--txt)}
    .helper{font-size:.8rem;color:var(--muted);margin-top:6px}

    .btn-calc{
      width:100%;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#0f172a;border:none;
      padding:14px;border-radius:10px;font-size:1.05rem;font-weight:800;cursor:pointer;margin-top:6px;
      transition:transform .1s, filter .15s
    }
    .btn-calc:hover{filter:brightness(1.03)}
    .btn-calc:active{transform:scale(.98)}

    .result-card{
      margin-top:22px;background:rgba(0,0,0,.3);border-radius:12px;overflow:hidden;border:1px solid var(--border);
      display:none;padding:0 16px
    }
    .result-card.active{display:block}
    .result-row{display:flex;justify-content:space-between;align-items:center;padding:14px 0;border-bottom:1px solid rgba(255,255,255,.05);gap:16px}
    .result-row:last-child{border-bottom:none}
    .result-label{font-size:.95rem;color:var(--muted)}
    .result-value{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1.15rem;font-weight:700;color:var(--txt);text-align:right}
    .result-strong{background:rgba(45,212,191,.1);padding:14px 0}

    .cpto-tag{
      background:var(--cpto-bg);color:var(--primary);padding:4px 8px;border-radius:6px;font-size:.75rem;font-weight:800;
      margin-left:8px;display:inline-flex;align-items:center;border:1px solid rgba(45,212,191,.3);white-space:nowrap
    }
    .cpto-tag.desc{background:var(--cpto-danger-bg);color:var(--danger);border-color:rgba(251,113,133,.3)}
    .pill{
      display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border:1px solid var(--info-border);
      background:var(--info-bg);border-radius:10px;color:var(--muted);font-size:.9rem
    }

    table{width:100%;border-collapse:collapse;margin-top:12px;font-size:.95rem}
    th,td{padding:10px;text-align:left;border-bottom:1px solid var(--border)}
    th{background:rgba(255,255,255,.05);font-weight:600;color:var(--txt)}

    /* Fundamento en tooltip (‚ìò) */
    .legal-line{margin-top:18px;display:flex;align-items:center;gap:10px;color:var(--muted);font-size:.9rem}
    .info-tip{position:relative;display:inline-flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:8px;
      border:1px solid var(--border);background:rgba(255,255,255,.03);cursor:help;color:var(--txt);font-weight:800}
    .info-tip .tip{
      position:absolute;left:0;top:28px;min-width:280px;max-width:520px;
      background:var(--card);border:1px solid var(--border);box-shadow:var(--shadow);
      padding:12px 14px;border-radius:12px;display:none;color:var(--txt);z-index:50
    }
    .info-tip:hover .tip, .info-tip:focus .tip{display:block}
    .tip small{color:var(--muted)}
    .tip strong{color:var(--primary)}

    .disclaimer-box{
      background:var(--warning-bg);border:1px solid var(--warning-border);border-left:4px solid var(--accent);
      padding:16px;border-radius:8px;margin-top:18px
    }
    .disclaimer-box p{color:#fde047;font-size:.9rem;margin:0;line-height:1.5}
    .disclaimer-box strong{color:var(--accent)}

    /* Toast */
    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background:rgba(15,23,42,.92);border:1px solid var(--border);color:var(--txt);
      padding:12px 14px;border-radius:12px;box-shadow:var(--shadow);
      display:none;max-width:min(92vw,720px)
    }
    .toast.show{display:block}
    .toast .muted{color:var(--muted)}
  </style>
</head>
<body>

<div class="container">
  <header>
    <div class="logo">CG</div>
    <div>
      <h1>Calculadoras de Prestaciones SNTSS</h1>
      <div class="subtitle">Herramientas basadas en tu CCT. F√°ciles, r√°pidas y transparentes.</div>
    </div>
  </header>

  <div class="global-search">
    <label for="buscador">üëã Para empezar, busca y selecciona tu categor√≠a (con su jornada):</label>

    <div class="autocomplete-wrapper">
      <input type="text" id="buscador" placeholder="Ej. Enfermera General, M√©dico Familiar, Aux. Limpieza..." autocomplete="off" aria-label="Buscador de categor√≠a">
    </div>

    <div id="user-data" class="user-data-bar" aria-live="polite">
      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Categor√≠a</span><br>
        <span id="ud-cat">-</span>
      </div>
      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Jornada</span><br>
        <span id="ud-jor">-</span> <span style="font-size:0.85rem; font-weight:normal;">hrs</span>
      </div>
      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Tabular (Cpto 02)</span><br>
        <span id="ud-tab" style="color:var(--primary);">$0.00</span>
      </div>

      <div>
        <span style="color:var(--muted); font-weight:normal; font-size:0.85rem;">Ayuda de Renta (Cpto 011)</span><br>
        <div style="display:flex; align-items:center; gap:6px; margin-top:2px;">
          <span style="font-weight:normal;">$</span>
          <input type="number" id="ud-renta" value="0" min="0" step="0.01"
                 style="width: 120px; padding: 8px; font-weight: 800; font-family: ui-monospace, monospace; font-size:1.05rem; background: var(--bg); border: 1px solid var(--border); border-radius:10px;"
                 inputmode="decimal"
                 aria-label="Ayuda de Renta Concepto 011">
        </div>
        <span class="hint">Pon el dato de tu tarjet√≥n. Puede variar por factores que no est√°n en la base.</span>
      </div>

      <div style="flex: 1 1 240px;">
        <div class="pill" title="Tip r√°pido">
          ‚úÖ Con esto, las calculadoras ya hacen las cuentas autom√°ticamente.
        </div>
      </div>
    </div>
  </div>

  <div class="layout">
    <nav class="menu" aria-label="Men√∫ de calculadoras">
      <button class="menu-btn active" data-panel="p-anticipo">Anticipo de Sueldo</button>
      <button class="menu-btn" data-panel="p-ahorro">Fondo de Ahorro (Julio)</button>
      <button class="menu-btn" data-panel="p-extra">Tiempo Extra</button>
      <button class="menu-btn" data-panel="p-hipo-largo">Hipotecario Largo (30 a√±os)</button>
      <button class="menu-btn" data-panel="p-hipo-medio">Hipotecario Medio (12 a√±os)</button>
      <button class="menu-btn" data-panel="p-auto">Cr√©dito para Auto</button>
      <button class="menu-btn" data-panel="p-aguinaldo">Aguinaldo y Anticipos</button>
    </nav>

    <main>

      <!-- 1) ANTICIPO -->
      <section id="p-anticipo" class="panel active" aria-labelledby="h-anticipo">
        <h2 id="h-anticipo">Anticipo de Sueldo</h2>
        <p class="desc">Descubre cu√°nto puedes pedir de adelanto de tu sueldo para un apuro y cu√°nto te descontar√°n a la quincena. ¬°Cero intereses!</p>

        <div class="form-group">
          <label for="ant_meses">¬øCu√°ntos meses necesitas que te adelanten?</label>
          <select id="ant_meses">
            <option value="1">1 mes (P√°galo en 10 quincenas)</option>
            <option value="2">2 meses (P√°galo en 20 quincenas)</option>
            <option value="3">3 meses (P√°galo en 30 quincenas)</option>
            <option value="4">4 meses (P√°galo en 40 quincenas)</option>
          </select>
        </div>

        <button class="btn-calc" data-action="calcAnticipo">Ver mi adelanto</button>

        <div id="res_anticipo" class="result-card" role="region" aria-label="Resultado anticipo">
          <div class="result-row">
            <span class="result-label">Te depositar√≠an m√°ximo:</span>
            <span class="result-value" id="ant_monto" style="color:var(--primary);">$0.00</span>
          </div>
          <div class="result-row">
            <span class="result-label">Terminar√≠as de pagarlo en:</span>
            <span class="result-value" id="ant_plazo">0 quincenas</span>
          </div>
          <div class="result-row">
            <span class="result-label">Descuento quincenal fijo en tu tarjet√≥n:<span class="cpto-tag desc">Deducci√≥n temporal</span></span>
            <span class="result-value" id="ant_desc" style="color:var(--danger);">-$0.00</span>
          </div>
        </div>

        <div class="legal-line">
          <span class="info-tip" tabindex="0" aria-label="Informaci√≥n de sustento legal">
            ‚ìò
            <span class="tip">
              üìñ <strong>Fundamento:</strong> Cl√°usula 97 del Contrato Colectivo de Trabajo (CCT).<br>
              <small>Tip: El dep√≥sito y el descuento dependen de tu base: (Cpto 02 + Cpto 011).</small>
            </span>
          </span>
          <span>Sustento legal (ver detalle)</span>
        </div>
      </section>

      <!-- 2) AHORRO -->
      <section id="p-ahorro" class="panel" aria-labelledby="h-ahorro">
        <h2 id="h-ahorro">Fondo de Ahorro (La 2da de Julio)</h2>
        <p class="desc">Calcula el pago anual de tu fondo de ahorro que cae en la segunda quincena de julio.</p>

        <div class="form-group">
          <label for="aho_dias">¬øCu√°ntos d√≠as laboraste en el √∫ltimo a√±o? (de julio a julio)</label>
          <input type="number" id="aho_dias" value="365" min="0" max="365" inputmode="numeric">
          <div class="helper">Lo normal es 365. B√°jalos si tuviste faltas o licencias sin goce.</div>
        </div>

        <button class="btn-calc" data-action="calcAhorro">Calcular mi fondo</button>

        <div id="res_ahorro" class="result-card" role="region" aria-label="Resultado ahorro">
          <div class="result-row">
            <span class="result-label">D√≠as proporcionales que generaste:</span>
            <span class="result-value" id="aho_dias_res">0 d√≠as</span>
          </div>
          <div class="result-row result-strong">
            <span class="result-label" style="color:var(--primary);font-weight:800;">
              Total a recibir (libre de impuestos): <span class="cpto-tag" style="background:var(--primary);color:#000;">Cpto 055</span>
            </span>
            <span class="result-value" id="aho_total" style="color:var(--primary);font-size:1.45rem;">$0.00</span>
          </div>
        </div>

        <div class="legal-line">
          <span class="info-tip" tabindex="0">‚ìò
            <span class="tip">
              üìñ <strong>Fundamento:</strong> Cl√°usula 144 del CCT.<br>
              <small>Se calcula con tu tabular (Cpto 02) y d√≠as proporcionales.</small>
            </span>
          </span>
          <span>Sustento legal (ver detalle)</span>
        </div>
      </section>

      <!-- 3) TIEMPO EXTRA -->
      <section id="p-extra" class="panel" aria-labelledby="h-extra">
        <h2 id="h-extra">Pago de Tiempo Extra</h2>
        <p class="desc">Conoce cu√°nto te pagar√°n por las horas adicionales que te quedaste a apoyar en tu servicio.</p>

        <div class="form-group">
          <label for="ext_horas">¬øCu√°ntas horas extra laboraste en la quincena?</label>
          <input type="number" id="ext_horas" placeholder="Ej. 4" min="0" step="0.5" inputmode="decimal">
        </div>

        <div class="form-group">
          <label for="ext_factor">¬øC√≥mo te las van a pagar?</label>
          <select id="ext_factor">
            <option value="2">Al doble (x2) ‚Äî hasta 9 horas semanales</option>
            <option value="3">Al triple (x3) ‚Äî m√°s de 9 horas o en descanso</option>
            <option value="4">Al cu√°druple (x4) ‚Äî festivo obligatorio + descanso</option>
          </select>
        </div>

        <button class="btn-calc" data-action="calcExtra">Calcular mis horas</button>

        <div id="res_extra" class="result-card" role="region" aria-label="Resultado tiempo extra">
          <div class="result-row">
            <span class="result-label">Tu hora (base) vale:</span>
            <span class="result-value" id="ext_base" style="font-size:1rem;color:var(--muted);">$0.00</span>
          </div>
          <div class="result-row">
            <span class="result-label" style="font-weight:800;">Total a recibir en efectivo: <span class="cpto-tag">Cpto 037</span></span>
            <span class="result-value" id="ext_total" style="color:var(--primary);">$0.00</span>
          </div>
        </div>

        <div class="legal-line">
          <span class="info-tip" tabindex="0">‚ìò
            <span class="tip">
              üìñ <strong>Fundamento:</strong> Cl√°usulas 32 y 33 del CCT, y Normativa de Conceptos de Pago (Cpto 037).<br>
              <small>F√≥rmula: (Cpto 02 + Cpto 011) / 30 / Jornada.</small>
            </span>
          </span>
          <span>Sustento legal (ver detalle)</span>
        </div>
      </section>

      <!-- 4) HIPOTECARIO LARGO -->
      <section id="p-hipo-largo" class="panel" aria-labelledby="h-hl">
        <h2 id="h-hl">Cr√©dito Hipotecario a Largo Plazo</h2>
        <p class="desc">Calcula cu√°nto te presta el Instituto para comprar, construir o reparar tu casa, y en cu√°nto quedar√° tu descuento quincenal a 30 a√±os.</p>

        <div class="form-group">
          <label for="hl_liq">¬øQu√© tan libre de deudas est√° tu tarjet√≥n de pago?</label>
          <select id="hl_liq">
            <option value="90">Mi tarjet√≥n est√° limpio y tengo buena capacidad</option>
            <option value="75">Tengo algunos descuentos o pr√©stamos activos</option>
          </select>
        </div>

        <button class="btn-calc" data-action="calcHipoLargo">Simular mi cr√©dito a 30 a√±os</button>

        <div id="res_hipo_largo" class="result-card" role="region" aria-label="Resultado hipotecario largo">
          <div class="result-row">
            <span class="result-label">Monto m√°ximo ideal:</span>
            <span class="result-value" id="hl_max" style="color:var(--primary);">$0.00</span>
          </div>
          <div class="result-row">
            <span class="result-label">Descuento quincenal (fijo): <span class="cpto-tag desc">Cpto 130</span></span>
            <span class="result-value" id="hl_desc" style="color:var(--danger);">-$0.00</span>
          </div>
        </div>

        <div class="disclaimer-box">
          <p>üí° <strong>Nota sobre tu Liquidez:</strong> Los montos mostrados son el m√°ximo al que tienes derecho por tu categor√≠a. Para que el IMSS te autorice estas cantidades exactas, revisar√°n tu Tarjet√≥n de Pago para asegurarse de que, despu√©s de cobrarte este nuevo pr√©stamo, te siga quedando dinero suficiente para tus gastos b√°sicos (al menos 15 d√≠as de salario m√≠nimo libre). Si tienes muchos descuentos activos, podr√≠an pedirte que liquides los menores antes de darte uno nuevo.</p>
        </div>

        <div class="legal-line">
          <span class="info-tip" tabindex="0">‚ìò
            <span class="tip">
              üìñ <strong>Fundamento:</strong> Cl√°usula 81 del CCT y Art√≠culos 4 y 6 del Reglamento de Pr√©stamos para el Fomento de la Habitaci√≥n.<br>
              <small>SMI = (Cpto 02 + Cpto 011) √ó 1.20; Descuento = (SMI √ó 0.25 o 0.30) / 2.</small>
            </span>
          </span>
          <span>Sustento legal (ver detalle)</span>
        </div>
      </section>

      <!-- 5) HIPOTECARIO MEDIO -->
      <section id="p-hipo-medio" class="panel" aria-labelledby="h-hm">
        <h2 id="h-hm">Cr√©dito Hipotecario a Mediano Plazo</h2>
        <p class="desc">Una opci√≥n de pr√©stamo para tu vivienda que liquidas mucho m√°s r√°pido (m√°ximo 12 a√±os).</p>

        <button class="btn-calc" data-action="calcHipoMedio">Simular mi cr√©dito a 12 a√±os</button>

        <div id="res_hipo_medio" class="result-card" role="region" aria-label="Resultado hipotecario medio">
          <div class="result-row">
            <span class="result-label">Monto m√°ximo ideal (35 meses):</span>
            <span class="result-value" id="hm_max" style="color:var(--primary);">$0.00</span>
          </div>
          <div class="result-row">
            <span class="result-label">Descuento quincenal (fijo): <span class="cpto-tag desc">Cpto 136</span></span>
            <span class="result-value" id="hm_desc" style="color:var(--danger);">-$0.00</span>
          </div>
        </div>

        <div class="disclaimer-box">
          <p>üí° <strong>Nota sobre tu Liquidez:</strong> Los montos mostrados son el m√°ximo al que tienes derecho por tu categor√≠a. Para que el IMSS te autorice estas cantidades exactas, revisar√°n tu Tarjet√≥n de Pago para asegurarse de que, despu√©s de cobrarte este nuevo pr√©stamo, te siga quedando dinero suficiente para tus gastos b√°sicos (al menos 15 d√≠as de salario m√≠nimo libre). Si tienes muchos descuentos activos, podr√≠an pedirte que liquides los menores antes de darte uno nuevo.</p>
        </div>

        <div class="legal-line">
          <span class="info-tip" tabindex="0">‚ìò
            <span class="tip">
              üìñ <strong>Fundamento:</strong> Cl√°usula 81 del CCT y Art√≠culos 25 y 27 del Reglamento de Pr√©stamos para el Fomento de la Habitaci√≥n.<br>
              <small>SMI = (Cpto 02 + Cpto 011) √ó 1.20; Monto m√°x = SMI √ó 35.</small>
            </span>
          </span>
          <span>Sustento legal (ver detalle)</span>
        </div>
      </section>

      <!-- 6) AUTO -->
      <section id="p-auto" class="panel" aria-labelledby="h-auto">
        <h2 id="h-auto">Cr√©dito de Autom√≥vil</h2>
        <p class="desc">Descubre de cu√°nto es tu cr√©dito para estrenar auto pag√°ndolo c√≥modamente en 5 a√±os (120 quincenas).</p>

        <button class="btn-calc" data-action="calcAuto">Simular mi cr√©dito automotriz</button>

        <div id="res_auto" class="result-card" role="region" aria-label="Resultado auto">
          <div class="result-row result-strong" style="padding:16px 0;border-bottom:none;">
            <span class="result-label" style="font-weight:800;color:var(--txt);">Monto m√°ximo ideal:</span>
            <span class="result-value" id="au_max" style="color:var(--primary);font-size:1.45rem;">$0.00</span>
          </div>
          <div style="padding:14px 0 16px 0;">
            <p style="font-size:.95rem;color:var(--muted);margin-bottom:8px;">
              Descuento quincenal proyectado (va bajando por a√±o): <span class="cpto-tag desc">Cpto 134</span>
            </p>
            <table>
              <tr><th>A√±o</th><th style="text-align:right;">Descuento quincenal</th></tr>
              <tr><td>A√±o 1</td><td id="au_y1" style="color:var(--danger);font-weight:800;text-align:right;font-family:ui-monospace,monospace;">$0.00</td></tr>
              <tr><td>A√±o 2</td><td id="au_y2" style="color:var(--danger);font-weight:800;text-align:right;font-family:ui-monospace,monospace;">$0.00</td></tr>
              <tr><td>A√±o 3</td><td id="au_y3" style="color:var(--danger);font-weight:800;text-align:right;font-family:ui-monospace,monospace;">$0.00</td></tr>
              <tr><td>A√±o 4</td><td id="au_y4" style="color:var(--danger);font-weight:800;text-align:right;font-family:ui-monospace,monospace;">$0.00</td></tr>
              <tr><td>A√±o 5</td><td id="au_y5" style="color:var(--danger);font-weight:800;text-align:right;font-family:ui-monospace,monospace;">$0.00</td></tr>
            </table>
          </div>
        </div>

        <div class="disclaimer-box">
          <p>üí° <strong>Nota sobre tu Liquidez:</strong> Los montos mostrados son el m√°ximo al que tienes derecho por tu categor√≠a. Para que el IMSS te autorice estas cantidades exactas, revisar√°n tu Tarjet√≥n de Pago para asegurarse de que, despu√©s de cobrarte este nuevo pr√©stamo, te siga quedando dinero suficiente para tus gastos b√°sicos (al menos 15 d√≠as de salario m√≠nimo libre). Si tienes muchos descuentos activos, podr√≠an pedirte que liquides los menores antes de darte uno nuevo.</p>
        </div>

        <div class="legal-line">
          <span class="info-tip" tabindex="0">‚ìò
            <span class="tip">
              üìñ <strong>Fundamento:</strong> Cl√°usula 146 del CCT.<br>
              <small>SMI = (Cpto 02 + Cpto 011) √ó 1.20; Monto m√°x = SMI √ó 24.</small>
            </span>
          </span>
          <span>Sustento legal (ver detalle)</span>
        </div>
      </section>

      <!-- 7) AGUINALDO -->
      <section id="p-aguinaldo" class="panel" aria-labelledby="h-ag">
        <h2 id="h-ag">Aguinaldo y Anticipos</h2>
        <p class="desc">El aguinaldo total equivale a 3 meses de sueldo. Conoce tus adelantos y el saldo libre de impuestos que recibir√°s en diciembre.</p>

        <div class="form-group">
          <label for="ag_agosto">¬øSolicitaste anticipo de un mes en agosto?</label>
          <select id="ag_agosto">
            <option value="no">No</option>
            <option value="si">S√≠</option>
          </select>
        </div>

        <button class="btn-calc" data-action="calcAguinaldo">Calcular mi aguinaldo</button>

        <div id="res_aguinaldo" class="result-card" role="region" aria-label="Resultado aguinaldo">
          <div class="result-row" style="background:rgba(255,255,255,.03);padding:12px 0;margin-bottom:6px;">
            <span class="result-label" style="font-weight:800;color:var(--txt);">Tus 3 meses completos valen:</span>
            <span class="result-value" id="ag_total" style="color:var(--muted);font-size:1.05rem;">$0.00</span>
          </div>

          <div class="result-row" style="padding:12px 0;">
            <span class="result-label">Adelanto de enero: <span class="cpto-tag">Cpto 047</span></span>
            <span class="result-value" id="ag_enero" style="color:var(--muted);font-size:1.05rem;">$0.00</span>
          </div>

          <div class="result-row" id="row_agosto" style="display:none;padding:12px 0;">
            <span class="result-label">Adelanto de agosto:</span>
            <span class="result-value" id="ag_ago_val" style="color:var(--muted);font-size:1.05rem;">$0.00</span>
          </div>

          <div class="result-row result-strong" style="padding:16px 0;">
            <span class="result-label" style="color:var(--primary);font-weight:900;">Saldo a recibir en diciembre: <span class="cpto-tag" style="background:var(--primary);color:#000;">Cpto 049</span></span>
            <span class="result-value" id="ag_dic" style="color:var(--primary);font-size:1.45rem;">$0.00</span>
          </div>
        </div>

        <div class="legal-line">
          <span class="info-tip" tabindex="0">‚ìò
            <span class="tip">
              üìñ <strong>Fundamento:</strong> Cl√°usula 107 del CCT.<br>
              <small>Base: (Cpto 02 + Cpto 011). Total = 3 meses; enero = 0.5; agosto = 1 (si aplica).</small>
            </span>
          </span>
          <span>Sustento legal (ver detalle)</span>
        </div>
      </section>

    </main>
  </div>
</div>

<div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
  // =============================================================
  // UTILIDADES
  // =============================================================
  const money = (n) => (Number.isFinite(n) ? n : 0)
    .toLocaleString('es-MX', { style: 'currency', currency: 'MXN' });

  const removeAccents = (str) =>
    (str ?? '').toString().normalize('NFD').replace(/[\u0300-\u036f]/g, '');

  const $ = (id) => document.getElementById(id);

  const toast = (() => {
    let t, timer;
    const show = (msg) => {
      if (!t) t = $('toast');
      t.innerHTML = msg;
      t.classList.add('show');
      clearTimeout(timer);
      timer = setTimeout(() => t.classList.remove('show'), 3200);
    };
    return { show };
  })();

  // =============================================================
  // ESTADO
  // =============================================================
  let userData = { tabular: 0, jornada: 8, renta: 0, categoria: '' };
  const THRESHOLD_MENSAJERO_8 = 4868.04; // regla: Mensajero 8.0 hrs

  // =============================================================
  // BASE DE DATOS (TABULAR + JORNADA)
  // NOTA: Concepto 011 se captura por usuario (por variaciones reales).
  // =============================================================
  const sueldosDB = [
    {"cat":"Pasante de Abogado","jor":"6.5","sm":5097.96},
    {"cat":"Abogado","jor":"6.5","sm":9125.04},
    {"cat":"Abogado","jor":"8.0","sm":11230.64},
    {"cat":"Auxiliar T√©cnico de Actuariado Social","jor":"6.5","sm":7553.14},
    {"cat":"Oficial T√©cnico de Actuariado Social","jor":"6.5","sm":8345.36},
    {"cat":"T√©cnico de Actuariado Social","jor":"6.5","sm":8932.24},
    {"cat":"Actuario Social Matem√°tico","jor":"6.5","sm":9581.5},
    {"cat":"Auxiliar de Servicios Administrativos","jor":"6.5","sm":3302.5},
    {"cat":"Auxiliar de Servicios Administrativos","jor":"8.0","sm":4064.76},
    {"cat":"Ayudante de Cajero B","jor":"8.0","sm":5022.12},
    {"cat":"Ayudante de Cajero A","jor":"8.0","sm":5330.68},
    {"cat":"Cajero D","jor":"6.5","sm":5351.94},
    {"cat":"Cajero D","jor":"8.0","sm":6587.36},
    {"cat":"Cajero C","jor":"8.0","sm":6999.44},
    {"cat":"Cajero B","jor":"6.5","sm":6084.36},
    {"cat":"Cajero A","jor":"8.0","sm":7656.68},
    {"cat":"Contador","jor":"6.5","sm":9125.04},
    {"cat":"Contador","jor":"8.0","sm":11230.64},
    {"cat":"Contador Auditor","jor":"6.5","sm":9125.04},
    {"cat":"Contador Auditor","jor":"8.0","sm":11230.64},
    {"cat":"Pasante de Economista","jor":"8.0","sm":5876.44},
    {"cat":"Economista","jor":"6.5","sm":9125.04},
    {"cat":"Economista","jor":"8.0","sm":11230.64},
    {"cat":"Soci√≥logo","jor":"6.5","sm":9125.04},
    {"cat":"Redactor B","jor":"6.5","sm":4583.28},
    {"cat":"Mensajero","jor":"6.5","sm":3955.4},
    {"cat":"Mensajero","jor":"8.0","sm":4868.04},
    {"cat":"Auxiliar Universal de Oficinas","jor":"6.5","sm":4746.16},
    {"cat":"Auxiliar Universal de Oficinas","jor":"8.0","sm":5841.44},
    {"cat":"Auxiliar de Soporte T√©cnico en Inform√°tica","jor":"8.0","sm":8340.48},
    {"cat":"Oficial de Soporte T√©cnico en Inform√°tica","jor":"8.0","sm":10242.12},
    {"cat":"Coordinador de Soporte T√©cnico en Inform√°tica","jor":"8.0","sm":11266.48},
    {"cat":"Oficial de Tesorer√≠a","jor":"8.0","sm":7068.14},
    {"cat":"Coordinador de Tesorer√≠a","jor":"8.0","sm":8340.48},
    {"cat":"Jefe de Grupo de Tesorer√≠a","jor":"8.0","sm":10242.12},
    {"cat":"Especialista de Tesorer√≠a","jor":"8.0","sm":11266.48},
    {"cat":"Oficial de Servicios T√©cnicos","jor":"8.0","sm":7068.14},
    {"cat":"Coordinador de Servicios T√©cnicos","jor":"8.0","sm":8340.48},
    {"cat":"Jefe de Grupo de Servicios T√©cnicos","jor":"8.0","sm":10242.12},
    {"cat":"Especialista de Servicios T√©cnicos","jor":"8.0","sm":11266.48},
    {"cat":"Oficial de Servicios Administrativos","jor":"8.0","sm":7068.14},
    {"cat":"Coordinador de Servicios Administrativos","jor":"8.0","sm":8340.48},
    {"cat":"Jefe de Grupo de Servicios Administrativos","jor":"8.0","sm":10242.12},
    {"cat":"Especialista de Servicios Administrativos","jor":"8.0","sm":11266.48},
    {"cat":"Oficial de Personal","jor":"8.0","sm":7068.14},
    {"cat":"Coordinador de Personal","jor":"8.0","sm":8340.48},
    {"cat":"Jefe de Grupo de Personal","jor":"8.0","sm":10242.12},
    {"cat":"Especialista de Personal","jor":"8.0","sm":11266.48},
    {"cat":"Oficial de Estad√≠stica","jor":"8.0","sm":7068.14},
    {"cat":"Coordinador de Estad√≠stica","jor":"8.0","sm":8340.48},
    {"cat":"Jefe de Grupo de Estad√≠stica","jor":"8.0","sm":10242.12},
    {"cat":"Especialista de Estad√≠stica","jor":"8.0","sm":11266.48},
    {"cat":"Oficial de Procesamiento de Datos","jor":"8.0","sm":7068.14},
    {"cat":"Coordinador de Procesamiento de Datos","jor":"8.0","sm":8340.48},
    {"cat":"Jefe de Grupo de Procesamiento de Datos","jor":"8.0","sm":10242.12},
    {"cat":"Especialista de Procesamiento de Datos","jor":"8.0","sm":11266.48},
    {"cat":"Oficial de Contabilidad","jor":"8.0","sm":7068.14},
    {"cat":"Coordinador de Contabilidad","jor":"8.0","sm":8340.48},
    {"cat":"Jefe de Grupo de Contabilidad","jor":"8.0","sm":10242.12},
    {"cat":"Especialista de Contabilidad","jor":"8.0","sm":11266.48},
    {"cat":"Jefe de Oficina A","jor":"8.0","sm":11266.48},
    {"cat":"Jefe T√©cnico de Cobranzas y Adeudos","jor":"8.0","sm":11266.48},
    {"cat":"M√©dico General","jor":"8.0","sm":9751.8},
    {"cat":"M√©dico Familiar","jor":"8.0","sm":12844.2},
    {"cat":"M√©dico No Familiar","jor":"8.0","sm":12844.2},
    {"cat":"Cirujano M√°xilo Facial","jor":"8.0","sm":12844.2},
    {"cat":"Estomat√≥logo","jor":"8.0","sm":11924.12},
    {"cat":"Ortopedista","jor":"8.0","sm":7875.28},
    {"cat":"Partera","jor":"6.5","sm":6837.68},
    {"cat":"Partera","jor":"8.0","sm":8415.48},
    {"cat":"Jefe de Parteras","jor":"6.5","sm":7350.52},
    {"cat":"Jefe de Parteras","jor":"8.0","sm":9046.64},
    {"cat":"Veterinario","jor":"6.5","sm":9125.04},
    {"cat":"Veterinario","jor":"8.0","sm":11230.64},
    {"cat":"Auxiliar de Enfermer√≠a General","jor":"8.0","sm":6108.68},
    {"cat":"Auxiliar de Enfermer√≠a en Salud P√∫blica","jor":"8.0","sm":6108.68},
    {"cat":"Enfermera General","jor":"8.0","sm":7381.12},
    {"cat":"Enfermera General Cl√≠nica (EGC)","jor":"8.0","sm":7898.3},
    {"cat":"Enfermera Especialista","jor":"8.0","sm":8415.48},
    {"cat":"Enfermera Jefe de Piso","jor":"8.0","sm":10242.12},
    {"cat":"Asistente M√©dica","jor":"6.5","sm":4963.16},
    {"cat":"Asistente M√©dica","jor":"8.0","sm":6108.68},
    {"cat":"Coordinadora de Asistentes M√©dicas","jor":"8.0","sm":6767.2},
    {"cat":"Trabajadora Social","jor":"6.5","sm":5897.4},
    {"cat":"Trabajadora Social","jor":"8.0","sm":7258.16},
    {"cat":"Trabajador Social Cl√≠nico","jor":"8.0","sm":8274.84},
    {"cat":"Auxiliar de Trabajo Social","jor":"6.5","sm":4667.16},
    {"cat":"Auxiliar de Trabajo Social","jor":"8.0","sm":5744.26},
    {"cat":"Nutricionista Dietista","jor":"6.5","sm":5897.4},
    {"cat":"Nutricionista Dietista","jor":"8.0","sm":7258.16},
    {"cat":"Especialista en Nutrici√≥n y Diet√©tica","jor":"8.0","sm":8415.48},
    {"cat":"Nutri√≥logo Cl√≠nico Especializado","jor":"8.0","sm":10242.12},
    {"cat":"Auxiliar de T√©cnico en Servicios de Dietolog√≠a","jor":"6.5","sm":5160.52},
    {"cat":"Auxiliar de T√©cnico en Servicios de Dietolog√≠a","jor":"8.0","sm":6351.46},
    {"cat":"Auxiliar de Administraci√≥n en Unidad M√©dica (Polivalente)","jor":"6.5","sm":4808.42},
    {"cat":"Auxiliar de Administraci√≥n en Unidad M√©dica (Polivalente)","jor":"8.0","sm":5917.9},
    {"cat":"Auxiliar de Enfermer√≠a en Unidad M√©dica (Polivalente)","jor":"6.5","sm":4924.46},
    {"cat":"Auxiliar de Enfermer√≠a en Unidad M√©dica (Polivalente)","jor":"8.0","sm":6060.88},
    {"cat":"T√©cnico Radi√≥logo","jor":"6.0","sm":5906.46},
    {"cat":"T√©cnico Radi√≥logo","jor":"8.0","sm":7875.28},
    {"cat":"Radioterapeuta","jor":"6.0","sm":5906.46},
    {"cat":"Radioterapeuta","jor":"8.0","sm":7875.28},
    {"cat":"Laboratorista","jor":"6.0","sm":6212.9},
    {"cat":"Laboratorista","jor":"8.0","sm":8283.66},
    {"cat":"Auxiliar de Laboratorio","jor":"6.0","sm":4732.06},
    {"cat":"Auxiliar de Laboratorio","jor":"8.0","sm":6309.58},
    {"cat":"Qu√≠mico Cl√≠nico","jor":"8.0","sm":11230.64},
    {"cat":"Qu√≠mico Cl√≠nico Jefe de Secci√≥n","jor":"8.0","sm":11793.36},
    {"cat":"Citotecn√≥logo","jor":"8.0","sm":7875.28},
    {"cat":"Histotecn√≥logo","jor":"6.0","sm":5906.46},
    {"cat":"Histotecn√≥logo","jor":"8.0","sm":7875.28},
    {"cat":"Inhaloterapeuta","jor":"6.0","sm":5906.46},
    {"cat":"Inhaloterapeuta","jor":"6.5","sm":6398.64},
    {"cat":"Inhaloterapeuta","jor":"8.0","sm":7875.28},
    {"cat":"Electrocardiografista","jor":"8.0","sm":7279.54},
    {"cat":"Fonoaudi√≥logo","jor":"6.0","sm":5906.46},
    {"cat":"Fonoaudi√≥logo","jor":"8.0","sm":7875.28},
    {"cat":"Optometrista","jor":"6.0","sm":5906.46},
    {"cat":"Optometrista","jor":"8.0","sm":7875.28},
    {"cat":"Psic√≥logo","jor":"8.0","sm":11230.64},
    {"cat":"Psic√≥logo Cl√≠nico","jor":"6.0","sm":8422.92},
    {"cat":"Psic√≥logo Cl√≠nico","jor":"8.0","sm":11230.64},
    {"cat":"Psic√≥metra","jor":"6.0","sm":5906.46},
    {"cat":"Psic√≥metra","jor":"8.0","sm":7875.28},
    {"cat":"T√©cnico en Anestesia","jor":"6.0","sm":6497.8},
    {"cat":"T√©cnico en Anestesia","jor":"8.0","sm":8663.78},
    {"cat":"T√©cnico en Manejo de Aparatos de Electrodiagn√≥stico","jor":"6.0","sm":5459.64},
    {"cat":"T√©cnico en Manejo de Aparatos de Electrodiagn√≥stico","jor":"8.0","sm":7279.54},
    {"cat":"T√©cnico en Medicina Nuclear","jor":"8.0","sm":7875.28},
    {"cat":"Terapista F√≠sico","jor":"6.0","sm":5906.46},
    {"cat":"Terapista F√≠sico","jor":"8.0","sm":7875.28},
    {"cat":"Terapista Ocupacional","jor":"6.0","sm":5906.46},
    {"cat":"Terapista Ocupacional","jor":"8.0","sm":7875.28},
    {"cat":"T√©cnico Polivalente","jor":"8.0","sm":5744.26},
    {"cat":"T√©cnico Electricista","jor":"8.0","sm":6090.42},
    {"cat":"T√©cnico Electr√≥nico","jor":"8.0","sm":6090.42},
    {"cat":"T√©cnico Mec√°nico","jor":"8.0","sm":6090.42},
    {"cat":"T√©cnico Plomero","jor":"8.0","sm":6090.42},
    {"cat":"T√©cnico A en Aire Acondicionado y Refrigeraci√≥n","jor":"8.0","sm":6727.66},
    {"cat":"T√©cnico A en Equipos M√©dicos","jor":"8.0","sm":6727.66},
    {"cat":"T√©cnico A en Fluidos y Energ√©ticos","jor":"8.0","sm":6727.66},
    {"cat":"T√©cnico A en Plantas de Lavado","jor":"8.0","sm":6727.66},
    {"cat":"T√©cnico A en Telecomunicaciones","jor":"8.0","sm":6727.66},
    {"cat":"T√©cnico B en Equipos M√©dicos","jor":"8.0","sm":7500.94},
    {"cat":"T√©cnico B en Fluidos y Energ√©ticos","jor":"8.0","sm":7500.94},
    {"cat":"T√©cnico B en Plantas de Lavado","jor":"8.0","sm":7500.94},
    {"cat":"T√©cnico B en Telecomunicaciones","jor":"8.0","sm":7500.94},
    {"cat":"T√©cnico en Equipos Reciprocantes","jor":"8.0","sm":7500.94},
    {"cat":"T√©cnico en Electr√≥nica M√©dica y Laboratorio","jor":"8.0","sm":8441.62},
    {"cat":"T√©cnico C en Fluidos y Energ√©ticos","jor":"8.0","sm":8441.62},
    {"cat":"T√©cnico C en Plantas de Lavado","jor":"8.0","sm":8441.62},
    {"cat":"T√©cnico C en Telecomunicaciones","jor":"8.0","sm":8441.62},
    {"cat":"T√©cnico en Mec√°nica, Fluidos y Especialidades","jor":"8.0","sm":8441.62},
    {"cat":"T√©cnico en Equipos de Absorci√≥n","jor":"8.0","sm":8441.62},
    {"cat":"T√©cnico en Equipos Helicoidal","jor":"8.0","sm":8441.62},
    {"cat":"T√©cnico en Equipos de Rayos X","jor":"8.0","sm":8441.62},
    {"cat":"T√©cnico en Equipos Turbocentr√≠fugo","jor":"8.0","sm":8441.62},
    {"cat":"Especialista en Equipos de Especialidades","jor":"8.0","sm":9591.02},
    {"cat":"Especialista en Equipos de Laboratorio","jor":"8.0","sm":9591.02},
    {"cat":"Especialista en Equipos de Mec√°nica y Fluidos","jor":"8.0","sm":9591.02},
    {"cat":"Especialista en Equipos de Aire Acondicionado y Refrig.","jor":"8.0","sm":9591.02},
    {"cat":"Especialista en Plantas de Lavado","jor":"8.0","sm":9591.02},
    {"cat":"Especialista en Equipos de Electr√≥nica M√©dica","jor":"8.0","sm":9591.02},
    {"cat":"Especialista en Equipos de Rayos X","jor":"8.0","sm":9591.02},
    {"cat":"Especialista en Fluidos y Energ√©ticos","jor":"8.0","sm":9591.02},
    {"cat":"Arquitecto","jor":"8.0","sm":11230.64},
    {"cat":"Dibujante de Construcci√≥n","jor":"6.5","sm":5831.5},
    {"cat":"Dibujante de Construcci√≥n","jor":"8.0","sm":7177.18},
    {"cat":"Dibujante de Estad√≠stica y Publicidad C","jor":"6.5","sm":4175.98},
    {"cat":"Dibujante de Estad√≠stica y Publicidad B","jor":"8.0","sm":5461.8},
    {"cat":"Dibujante de Estad√≠stica y Publicidad A","jor":"6.5","sm":5831.5},
    {"cat":"Dibujante de Estad√≠stica y Publicidad A","jor":"8.0","sm":7177.18},
    {"cat":"Dibujante de Ingenier√≠a y Arquitectura","jor":"6.5","sm":5831.5},
    {"cat":"Dibujante de Ingenier√≠a y Arquitectura","jor":"8.0","sm":7177.18},
    {"cat":"Auxiliar de Almac√©n","jor":"6.5","sm":4746.16},
    {"cat":"Auxiliar de Almac√©n","jor":"8.0","sm":5841.44},
    {"cat":"Oficial de Almac√©n","jor":"8.0","sm":7068.14},
    {"cat":"Coordinador de Almac√©n","jor":"8.0","sm":8340.48},
    {"cat":"Jefe de Grupo de Almac√©n","jor":"8.0","sm":10242.12},
    {"cat":"Especialista de Almac√©n","jor":"8.0","sm":11266.48},
    {"cat":"Auxiliar de Servicios de Intendencia","jor":"6.5","sm":3961.3},
    {"cat":"Auxiliar de Servicios de Intendencia","jor":"8.0","sm":4875.46},
    {"cat":"Ayudante de Servicios de Intendencia","jor":"8.0","sm":5648.58},
    {"cat":"Oficial de Servicios de Intendencia","jor":"8.0","sm":6098.68},
    {"cat":"Intendente","jor":"8.0","sm":6565.76},
    {"cat":"Auxiliar de Limpieza e Higiene (M√©dicas y No M√©dicas)","jor":"8.0","sm":4875.46},
    {"cat":"Ayudante de Limpieza e Higiene (M√©dicas y No M√©dicas)","jor":"8.0","sm":5648.58},
    {"cat":"Auxiliar de Limpieza y Cocina en Unidad M√©dica","jor":"6.5","sm":3990.86},
    {"cat":"Auxiliar de Limpieza y Cocina en Unidad M√©dica","jor":"8.0","sm":4911.82},
    {"cat":"Auxiliar de Servicios Generales en Unidad M√©dica","jor":"6.5","sm":4742.96},
    {"cat":"Auxiliar de Servicios Generales en Unidad M√©dica","jor":"8.0","sm":5837.3},
    {"cat":"Operador de Servicios de Lavander√≠a","jor":"6.5","sm":4571.8},
    {"cat":"Operador de Servicios de Lavander√≠a","jor":"8.0","sm":5626.62},
    {"cat":"Oficial de Servicios de Lavander√≠a","jor":"6.5","sm":4935.84},
    {"cat":"Oficial de Servicios de Lavander√≠a","jor":"8.0","sm":6074.84},
    {"cat":"Manejador de Alimentos","jor":"6.5","sm":3961.3},
    {"cat":"Manejador de Alimentos","jor":"8.0","sm":4875.46},
    {"cat":"Cocinero T√©cnico 2","jor":"6.5","sm":4589.44},
    {"cat":"Cocinero T√©cnico 2","jor":"8.0","sm":5648.58},
    {"cat":"Cocinero T√©cnico 1","jor":"6.5","sm":4955.02},
    {"cat":"Cocinero T√©cnico 1","jor":"8.0","sm":6098.68},
    {"cat":"Chofer","jor":"6.5","sm":4662.28},
    {"cat":"Chofer","jor":"8.0","sm":5738.04},
    {"cat":"Motociclista","jor":"6.5","sm":4662.28},
    {"cat":"Motociclista","jor":"8.0","sm":5738.04},
    {"cat":"Controlador de Veh√≠culos","jor":"6.5","sm":5937.82},
    {"cat":"Controlador de Veh√≠culos","jor":"8.0","sm":7308.0},
    {"cat":"Enfermera para el Traslado de Pacientes de Urgencia","jor":"8.0","sm":7381.12},
    {"cat":"Enfermera para Traslado de Pacientes Terapia Intensiva","jor":"8.0","sm":8415.48},
    {"cat":"T√©cnico Operador Transporte Pacientes de Urgencia","jor":"8.0","sm":7193.64},
    {"cat":"T√©cnico Operador Transporte Pacientes Terapia Intens.","jor":"8.0","sm":7783.54},
    {"cat":"M√©dico para el Traslado de Pacientes de Urgencia","jor":"8.0","sm":12844.2},
    {"cat":"M√©dico para Traslado de Pacientes Terapia Intensiva","jor":"8.0","sm":12844.2},
    {"cat":"Camillero Veh√≠culos Serv. Ord. y Prog. (D.F. y Valle)","jor":"8.0","sm":5748.92},
    {"cat":"Operador de Veh√≠culos Serv. Ord. y Prog. (D.F. y Valle)","jor":"8.0","sm":6766.56},
    {"cat":"Operador de Ambulancias (For√°neo)","jor":"6.5","sm":4998.14},
    {"cat":"Operador de Ambulancias (For√°neo)","jor":"8.0","sm":6151.64},
    {"cat":"Controlador Veh√≠culos Serv. Ord. y Prog.","jor":"6.5","sm":5937.82},
    {"cat":"Controlador Veh√≠culos Serv. Ord. y Prog.","jor":"8.0","sm":7308.0},
    {"cat":"Camillero de Unidades Hospitalarias","jor":"8.0","sm":5748.92},
    {"cat":"Elevadorista","jor":"6.5","sm":4154.86},
    {"cat":"Elevadorista","jor":"8.0","sm":5113.92},
    {"cat":"Ayudante de Autopsia","jor":"6.5","sm":5326.04},
    {"cat":"Ayudante de Autopsia","jor":"8.0","sm":6555.1},
    {"cat":"Auxiliar de Farmacia","jor":"6.5","sm":5220.34},
    {"cat":"Auxiliar de Farmacia","jor":"8.0","sm":6424.6},
    {"cat":"Ayudante de Farmacia","jor":"8.0","sm":7180.26},
    {"cat":"Oficial de Farmacia","jor":"8.0","sm":8329.04},
    {"cat":"Coordinador de Farmacia","jor":"8.0","sm":9800.3},
    {"cat":"Guardavidas","jor":"6.5","sm":4571.8},
    {"cat":"Heliografista","jor":"8.0","sm":6673.96},
    {"cat":"T√©cnico de Microfotograf√≠a","jor":"8.0","sm":7875.28},
    {"cat":"Machetero","jor":"6.5","sm":4071.5},
    {"cat":"Machetero","jor":"8.0","sm":5011.44},
    {"cat":"Masajista","jor":"6.5","sm":3908.44},
    {"cat":"Multilitista","jor":"6.5","sm":5209.52},
    {"cat":"Multilitista","jor":"8.0","sm":6411.42},
    {"cat":"Operador de Equipo A (Intercom. Neum√°tica)","jor":"6.5","sm":6442.26},
    {"cat":"Operador de M√°quinas de Revelado Autom√°tico","jor":"8.0","sm":5626.62},
    {"cat":"Peluquero","jor":"8.0","sm":4963.88},
    {"cat":"Preparador de mezclas","jor":"8.0","sm":11230.64},
    {"cat":"Operador Telef√≥nico A","jor":"6.5","sm":4667.16},
    {"cat":"Operador Telef√≥nico A","jor":"8.0","sm":5744.26},
    {"cat":"Operador Telef√≥nico B","jor":"8.0","sm":6678.82},
    {"cat":"Operador Telef√≥nico C","jor":"8.0","sm":7844.5},
    {"cat":"Coordinador de Operadores Telef√≥nicos","jor":"8.0","sm":9308.32},
    {"cat":"Operador General en Tiendas","jor":"8.0","sm":5841.44},
    {"cat":"Jefe de L√≠nea en Tiendas","jor":"8.0","sm":6226.66},
    {"cat":"Auxiliar de Velatorio","jor":"8.0","sm":4880.0},
    {"cat":"Operador de Velatorio","jor":"8.0","sm":5738.04},
    {"cat":"Ayudante de Embalsamamiento","jor":"8.0","sm":6136.0},
    {"cat":"Yesista","jor":"8.0","sm":5744.26},
    {"cat":"Cuidador de Animales","jor":"8.0","sm":5626.62},
    {"cat":"T√©cnico de Bibliotecas","jor":"6.5","sm":5589.56},
    {"cat":"T√©cnico de Bibliotecas","jor":"8.0","sm":6879.38},
    {"cat":"Asistente de Bibliotecario","jor":"6.5","sm":7396.12},
    {"cat":"Asistente de Bibliotecario","jor":"8.0","sm":9103.14},
    {"cat":"Bibliotecario","jor":"6.5","sm":9125.04},
    {"cat":"Bibliotecario","jor":"8.0","sm":11230.64},
    {"cat":"Bi√≥logo","jor":"8.0","sm":11230.64},
    {"cat":"Auxiliar de Administraci√≥n de C.V.","jor":"8.0","sm":5744.26},
    {"cat":"Auxiliar de Atenci√≥n M√©dica de C.V.","jor":"8.0","sm":5697.86},
    {"cat":"Auxiliar de Hospedaje de C.V.","jor":"8.0","sm":5787.78},
    {"cat":"Auxiliar de Operaci√≥n Contable de C.V.","jor":"8.0","sm":6678.82},
    {"cat":"Lavandero en Centros Vacacionales","jor":"8.0","sm":5626.62},
    {"cat":"Operador de Seguridad en Albercas de C.V.","jor":"8.0","sm":5626.62},
    {"cat":"Operador de Servicios Internos de C.V.","jor":"8.0","sm":4875.46},
    {"cat":"Operador de Veh√≠culos de C.V.","jor":"8.0","sm":5738.04},
    {"cat":"Planchador en Centros Vacacionales","jor":"8.0","sm":5626.62},
    {"cat":"Vigilante de Centros Vacacionales","jor":"8.0","sm":4875.46},
    {"cat":"Educadora","jor":"6.0","sm":5469.06},
    {"cat":"Educadora","jor":"6.5","sm":5924.68},
    {"cat":"Educadora","jor":"8.0","sm":7291.94},
    {"cat":"Oficial de Puericultura","jor":"6.5","sm":4667.16},
    {"cat":"Oficial de Puericultura","jor":"8.0","sm":5744.26},
    {"cat":"T√©cnico de Puericultura","jor":"8.0","sm":6230.44},
    {"cat":"Orientador","jor":"6.5","sm":6557.9},
    {"cat":"Orientador","jor":"8.0","sm":8071.42},
    {"cat":"Orientador de Actividades Familiares","jor":"20.0","sm":4116.02},
    {"cat":"Orientador Actividades Art√≠sticas (Cl√°sica/Moderna)","jor":"20.0","sm":3531.36},
    {"cat":"Orientador Actividades Art√≠sticas (Danza Regional)","jor":"20.0","sm":3767.66},
    {"cat":"Orientador Actividades Art√≠sticas (Maestro M√∫sica)","jor":"20.0","sm":3531.36},
    {"cat":"Orientador Actividades Art√≠sticas (Arte Dram√°tico)","jor":"20.0","sm":3874.68},
    {"cat":"Orientador de Educaci√≥n F√≠sica","jor":"20.0","sm":4154.68},
    {"cat":"Orientador de Iniciaci√≥n Cultural","jor":"20.0","sm":3531.36},
    {"cat":"Orientador T√©cnico M√©dico","jor":"20.0","sm":5820.22},
    {"cat":"Auxiliar de Orientador T√©cnico M√©dico","jor":"6.5","sm":4054.16},
    {"cat":"Pianista","jor":"1.5","sm":3291.18},
    {"cat":"Profesor de Educaci√≥n F√≠sica A","jor":"4.0","sm":4127.42},
    {"cat":"Profesor de Educaci√≥n F√≠sica A","jor":"6.0","sm":5332.22},
    {"cat":"Profesor de Educaci√≥n F√≠sica A","jor":"8.0","sm":7109.82},
    {"cat":"Profesor de Educaci√≥n F√≠sica B","jor":"4.0","sm":4604.38},
    {"cat":"Profesor de Educaci√≥n F√≠sica B","jor":"6.0","sm":6047.7},
    {"cat":"Profesor de Educaci√≥n F√≠sica B","jor":"8.0","sm":8063.58},
    {"cat":"Profesor de Educaci√≥n F√≠sica C","jor":"4.0","sm":5182.08},
    {"cat":"Profesor de Educaci√≥n F√≠sica C","jor":"6.0","sm":6914.4},
    {"cat":"Profesor de Educaci√≥n F√≠sica C","jor":"8.0","sm":9219.34},
    {"cat":"Promotor de Estomatolog√≠a","jor":"8.0","sm":11230.64},
    {"cat":"Promotor de Salud Comunitaria","jor":"8.0","sm":7068.14},
    {"cat":"Aux. de Administraci√≥n (Esquema Modificado y Campo)","jor":"8.0","sm":5917.9},
    {"cat":"Aux. de Atenci√≥n M√©dica (Esquema Modificado y Campo)","jor":"8.0","sm":6108.68},
    {"cat":"Auxiliar de Laboratorio (Esquema Modificado y Campo)","jor":"8.0","sm":6309.58},
    {"cat":"Aux. Servicios Generales (Esquema Modificado y Campo)","jor":"8.0","sm":4990.68},
    {"cat":"Estomat√≥logo (Esquema Modificado y Campo)","jor":"6.0","sm":8869.12},
    {"cat":"Operador Serv. Radiodiagn√≥stico (Esq. Mod. y Campo)","jor":"8.0","sm":6309.58},
    {"cat":"Auxiliar de Administraci√≥n (Unidad M√©dica de Campo)","jor":"8.0","sm":5917.9},
    {"cat":"Auxiliar de √Årea M√©dica (Unidad M√©dica de Campo)","jor":"8.0","sm":6108.68},
    {"cat":"Aux. de Servicios Generales (Unidad M√©dica de Campo)","jor":"8.0","sm":4990.68},
    {"cat":"Estomat√≥logo en Unidad M√©dica de Campo","jor":"8.0","sm":7748.32},
    {"cat":"Operador de Mantenimiento (Unidad M√©dica de Campo)","jor":"8.0","sm":4990.68},
    {"cat":"Operador Servicios Auxiliares Laboratorio (U.M. Campo)","jor":"8.0","sm":6309.58},
    {"cat":"Operador Servicios Auxiliares Rayos X (U.M. Campo)","jor":"8.0","sm":6309.58},
    {"cat":"Auxiliar de Administraci√≥n en H.R.","jor":"8.0","sm":5917.9},
    {"cat":"Auxiliar de √Årea M√©dica en H.R.","jor":"8.0","sm":6108.68},
    {"cat":"Auxiliar de Enfermer√≠a General en H.R.","jor":"8.0","sm":6108.68},
    {"cat":"Auxiliar de Enfermer√≠a General en U.M.R.","jor":"8.0","sm":6108.68},
    {"cat":"Auxiliar de Servicios Generales en H.R.","jor":"8.0","sm":4990.68},
    {"cat":"Citotecn√≥logo en H.R.","jor":"8.0","sm":7337.54},
    {"cat":"Enfermera Especialista Quir√∫rgica H.R.","jor":"8.0","sm":8415.48},
    {"cat":"Enfermera General en H.R.","jor":"8.0","sm":7310.08},
    {"cat":"Enfermera General Cl√≠nica en Unidad del Programa","jor":"8.0","sm":7898.3},
    {"cat":"Estomat√≥logo en H.R.","jor":"8.0","sm":11924.12},
    {"cat":"Laboratorista en H.R.","jor":"8.0","sm":8349.78},
    {"cat":"M√©dico General en U.M.C.","jor":"8.0","sm":9751.8},
    {"cat":"M√©dico No Familiar H.R.","jor":"8.0","sm":12844.2},
    {"cat":"Nutricionista Dietista en H.R.","jor":"8.0","sm":7310.08},
    {"cat":"Oficial de Conservaci√≥n en H.R.","jor":"8.0","sm":5709.56},
    {"cat":"Operador de Mantenimiento en H.R.","jor":"8.0","sm":5709.56},
    {"cat":"Operador de Serv. Auxiliares (Laboratorio) en H.R.","jor":"8.0","sm":6309.58},
    {"cat":"Operador de Serv. Auxiliares (Radiodiagn√≥stico) en H.R.","jor":"8.0","sm":6309.58},
    {"cat":"Trabajadora Social en H.R.","jor":"8.0","sm":7310.08},
    {"cat":"Residente (R1)","jor":"","sm":2810.74},
    {"cat":"Residente (R2)","jor":"","sm":3042.46},
    {"cat":"Residente (R3)","jor":"","sm":3119.54},
    {"cat":"Residente (R4)","jor":"","sm":3197.52},
    {"cat":"Residente (R5)","jor":"","sm":3293.5},
    {"cat":"Residente (R6)","jor":"","sm":3392.26},
    {"cat":"Residente (R7)","jor":"","sm":3494.16},
    {"cat":"Residente (R8)","jor":"","sm":3598.82}
  ];

  // =============================================================
  // AUTOCOMPLETE (a prueba de acentos)
  // =============================================================
  const searchInput = $('buscador');

  function closeLists() {
    const x = document.getElementsByClassName("autocomplete-items");
    while (x[0]) x[0].parentNode.removeChild(x[0]);
  }

  function seleccionarPuesto(item) {
    searchInput.value = `${item.cat} (${item.jor || '-'} hrs)`;
    userData.tabular = Number(item.sm) || 0;
    userData.jornada = parseFloat(item.jor) || 8; // residentes: default 8
    userData.categoria = item.cat;

    // renta: usuario la captura; solo la validamos aqu√≠ y en input event.
    updateRentaGlobal();

    $('ud-cat').innerText = item.cat;
    $('ud-jor').innerText = item.jor || '-';
    $('ud-tab').innerText = money(userData.tabular);

    $('user-data').classList.add('active');
    toast.show(`‚úÖ Categor√≠a seleccionada: <b>${item.cat}</b> <span class="muted">(${item.jor || '-'} hrs)</span>`);
  }

  function renderAutocomplete(matches) {
    closeLists();
    if (!matches.length) return;

    const wrap = searchInput.parentNode;
    const list = document.createElement("DIV");
    list.setAttribute("class", "autocomplete-items");
    wrap.appendChild(list);

    matches.forEach(item => {
      const row = document.createElement("DIV");
      row.innerHTML =
        `<div><strong>${item.cat}</strong> <span style="color:var(--muted); font-size:0.85rem;">(${item.jor || '-'} hrs)</span></div>
         <div style="color:var(--primary); font-weight:900;">${money(item.sm)}</div>`;
      row.addEventListener("click", () => { seleccionarPuesto(item); closeLists(); });
      list.appendChild(row);
    });
  }

  // Input listener con throttle suave (para performance)
  let acTimer = null;
  searchInput.addEventListener('input', function () {
    clearTimeout(acTimer);
    acTimer = setTimeout(() => {
      const raw = this.value.trim();
      closeLists();
      if (!raw) return;

      const searchVal = removeAccents(raw.toLowerCase());

      const matches = sueldosDB
        .filter(i => removeAccents((i.cat || '').toLowerCase()).includes(searchVal))
        .slice(0, 15);

      renderAutocomplete(matches);
    }, 80);
  });

  document.addEventListener("click", (e) => {
    // No cerrar si el click fue dentro del wrapper
    if (!e.target.closest('.autocomplete-wrapper')) closeLists();
  });

  // =============================================================
  // RENTA (Cpto 011) - usuario la captura (por variaciones reales)
  // =============================================================
  const rentaInput = $('ud-renta');

  function updateRentaGlobal() {
    let val = parseFloat(rentaInput.value);

    if (Number.isNaN(val) || val < 0) {
      toast.show("‚ö†Ô∏è La Ayuda de Renta (Cpto 011) no parece v√°lida. Se ajust√≥ a $0.00");
      rentaInput.value = "0";
      userData.renta = 0;
      return;
    }

    // Aviso suave si est√° fuera de rango t√≠pico, sin bloquear
    if (val > 15000) {
      toast.show("üëÄ Ojo: ese monto de Cpto 011 se ve alto. Verifica tu tarjet√≥n (lo dej√© tal cual).");
    }

    userData.renta = val;
  }

  rentaInput.addEventListener('input', () => updateRentaGlobal());
  rentaInput.addEventListener('change', () => updateRentaGlobal());

  // =============================================================
  // NAVEGACI√ìN
  // =============================================================
  function openPanel(panelId, btnEl) {
    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
    $(panelId).classList.add('active');
    btnEl.classList.add('active');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  document.querySelectorAll('.menu-btn').forEach(btn => {
    btn.addEventListener('click', () => openPanel(btn.dataset.panel, btn));
  });

  // =============================================================
  // VALIDACI√ìN
  // =============================================================
  function validarDatos() {
    if (!userData.tabular || userData.tabular <= 0) {
      toast.show("üëã Primero selecciona tu categor√≠a en el buscador de arriba.");
      searchInput.focus();
      return false;
    }
    // renta ya puede ser 0; se valida con updateRentaGlobal
    return true;
  }

  // =============================================================
  // REGLAS
  // =============================================================
  function getPorcentajeHipotecario() {
    // 25% si tabular <= Mensajero 8.0; si no, 30%
    return userData.tabular <= THRESHOLD_MENSAJERO_8 ? 0.25 : 0.30;
  }

  function sueldoBase() { // Base de c√°lculo: Cpto 02 + Cpto 011
    return (userData.tabular + userData.renta);
  }

  function smi() { // Salario Mensual Integrado
    return sueldoBase() * 1.20;
  }

  // =============================================================
  // 1) ANTICIPO
  // =============================================================
  function calcAnticipo() {
    if (!validarDatos()) return;

    const sueldo = sueldoBase();
    const meses = parseInt($('ant_meses').value, 10);

    const monto = sueldo * meses;
    const plazo = meses * 10;
    const desc = monto / plazo;

    $('ant_monto').innerText = money(monto);
    $('ant_plazo').innerText = `${plazo} quincenas`;
    $('ant_desc').innerText = `-${money(desc)}`;
    $('res_anticipo').classList.add('active');
  }

  // =============================================================
  // 2) FONDO AHORRO
  // =============================================================
  function calcAhorro() {
    if (!validarDatos()) return;

    let diasLab = parseFloat($('aho_dias').value);
    if (Number.isNaN(diasLab) || diasLab < 0) diasLab = 0;
    if (diasLab > 365) diasLab = 365;

    const salarioDiario = userData.tabular / 30;
    const diasPagar = 46 * (diasLab / 365);
    const total = salarioDiario * diasPagar;

    $('aho_dias_res').innerText = `${diasPagar.toFixed(2)} d√≠as`;
    $('aho_total').innerText = money(total);
    $('res_ahorro').classList.add('active');
  }

  // =============================================================
  // 3) TIEMPO EXTRA
  // =============================================================
  function calcExtra() {
    if (!validarDatos()) return;

    const horas = parseFloat($('ext_horas').value) || 0;
    const factor = parseInt($('ext_factor').value, 10);

    const costoHora = sueldoBase() / 30 / userData.jornada;
    const total = costoHora * factor * horas;

    $('ext_base').innerText = money(costoHora);
    $('ext_total').innerText = money(total);
    $('res_extra').classList.add('active');
  }

  // =============================================================
  // 4) HIPOTECARIO LARGO
  // =============================================================
  function calcHipoLargo() {
    if (!validarDatos()) return;

    const liq = parseInt($('hl_liq').value, 10); // 75 o 90
    const SMI = smi();
    const max = SMI * liq;
    const porcentaje = getPorcentajeHipotecario();
    const desc = (SMI * porcentaje) / 2;

    $('hl_max').innerText = money(max);
    $('hl_desc').innerText = `-${money(desc)}`;
    $('res_hipo_largo').classList.add('active');
  }

  // =============================================================
  // 5) HIPOTECARIO MEDIO
  // =============================================================
  function calcHipoMedio() {
    if (!validarDatos()) return;

    const SMI = smi();
    const max = SMI * 35;
    const porcentaje = getPorcentajeHipotecario();
    const desc = (SMI * porcentaje) / 2;

    $('hm_max').innerText = money(max);
    $('hm_desc').innerText = `-${money(desc)}`;
    $('res_hipo_medio').classList.add('active');
  }

  // =============================================================
  // 6) AUTO
  // =============================================================
  function calcAuto() {
    if (!validarDatos()) return;

    const SMI = smi();
    const max = SMI * 24;

    $('au_max').innerText = money(max);
    $('au_y1').innerText = `-${money((SMI * 0.40) / 2)}`;
    $('au_y2').innerText = `-${money((SMI * 0.39) / 2)}`;
    $('au_y3').innerText = `-${money((SMI * 0.38) / 2)}`;
    $('au_y4').innerText = `-${money((SMI * 0.37) / 2)}`;
    $('au_y5').innerText = `-${money((SMI * 0.36) / 2)}`;

    $('res_auto').classList.add('active');
  }

  // =============================================================
  // 7) AGUINALDO
  // =============================================================
  function calcAguinaldo() {
    if (!validarDatos()) return;

    const pideAgosto = $('ag_agosto').value === 'si';
    const sueldo = sueldoBase();

    const total = sueldo * 3;
    const enero = sueldo * 0.5;
    const agosto = pideAgosto ? sueldo * 1 : 0;
    const dic = total - enero - agosto;

    $('ag_total').innerText = money(total);
    $('ag_enero').innerText = money(enero);

    if (pideAgosto) {
      $('row_agosto').style.display = 'flex';
      $('ag_ago_val').innerText = money(agosto);
    } else {
      $('row_agosto').style.display = 'none';
    }

    $('ag_dic').innerText = money(dic);
    $('res_aguinaldo').classList.add('active');
  }

  // =============================================================
  // EVENT DELEGATION (un solo listener para todos los botones)
  // =============================================================
  const actions = {
    calcAnticipo,
    calcAhorro,
    calcExtra,
    calcHipoLargo,
    calcHipoMedio,
    calcAuto,
    calcAguinaldo
  };

  document.addEventListener('click', (e) => {
    const btn = e.target.closest('[data-action]');
    if (!btn) return;
    const fn = actions[btn.dataset.action];
    if (typeof fn === 'function') fn();
  });

  // Enter en buscador: si hay exactamente 1 match, selecciona
  searchInput.addEventListener('keydown', (e) => {
    if (e.key !== 'Enter') return;
    const raw = searchInput.value.trim();
    if (!raw) return;

    const searchVal = removeAccents(raw.toLowerCase());
    const matches = sueldosDB.filter(i => removeAccents((i.cat || '').toLowerCase()).includes(searchVal));

    if (matches.length === 1) {
      seleccionarPuesto(matches[0]);
      closeLists();
      e.preventDefault();
    }
  });
</script>
</body>
</html>
