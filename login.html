<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Acceso ‚Äî Unidad en Acci√≥n</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<style>
  :root{
    --bg:#0b1022; --panel:#0e1730; --panel2:#0b1429;
    --ring:rgba(91,215,242,.35);
    --txt:#e6fbff; --muted:#aee9f7; --accent:#5bd7f2; --sky:#60a5fa;
    --ok:#46d19e; --err:#ff7b7b;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:
    radial-gradient(70vmax 70vmax at 50% 20%, rgba(96,165,250,.12), transparent 60%),
    radial-gradient(60vmax 60vmax at 80% 80%, rgba(91,215,242,.10), transparent 60%),
    linear-gradient(180deg,#0b1220,#0b1022);
    color:var(--txt); font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu}
  .grid-bg::before{content:"";position:fixed;inset:0;pointer-events:none;opacity:.18;
    background-image:linear-gradient(to right, rgba(96,165,250,.12) 1px, transparent 1px),
                     linear-gradient(to bottom, rgba(91,215,242,.10) 1px, transparent 1px);
    background-size:48px 48px,48px 48px}
  .wrap{min-height:100%;display:grid;place-items:center;padding:20px}
  .card{
    width:min(920px,95vw); background:linear-gradient(180deg,var(--panel),#0b1328);
    border:1px solid rgba(91,215,242,.28); border-radius:20px; overflow:hidden;
    box-shadow:0 10px 40px rgba(0,0,0,.45)
  }
  .head{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    padding:14px 16px; border-bottom:1px solid rgba(91,215,242,.25);
    background:linear-gradient(180deg,var(--panel2),transparent)
  }
  .brand{display:flex; align-items:center; gap:12px}
  .brand img{width:42px;height:42px;border-radius:10px;object-fit:contain;background:#061022;border:1px solid rgba(91,215,242,.25)}
  .brand h1{margin:0;font-size:18px;color:#d8fbff}
  .brand small{display:block;color:#9fdff0;font-weight:500;margin-top:2px}
  .back{font-size:13px; color:#c8f6ff; background:rgba(91,215,242,.14);
    border:1px solid rgba(91,215,242,.32); padding:8px 10px; border-radius:10px; text-decoration:none}
  .body{display:grid; grid-template-columns:1.1fr .9fr; gap:0; min-height:380px}
  @media (max-width:860px){ .body{grid-template-columns:1fr} }
  .col{padding:16px}
  .left{border-right:1px solid rgba(91,215,242,.16)}
  .tabs{display:flex;gap:10px;margin-bottom:12px}
  .tab{appearance:none;border:1px solid rgba(91,215,242,.35); background:rgba(91,215,242,.14);
    color:#e6fbff;border-radius:12px;padding:8px 12px;font-size:14px;cursor:pointer}
  .tab.active{background:linear-gradient(90deg,var(--accent),var(--sky)); color:#072133; border:none}
  form{display:grid;gap:10px}
  label{font-size:12px;color:#bdefff}
  input{
    width:100%;padding:12px;border-radius:12px;border:1px solid rgba(91,215,242,.28);
    background:#0a1329;color:#e6fbff;outline:none
  }
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .btn{appearance:none;border:1px solid rgba(91,215,242,.45);background:rgba(91,215,242,.14);
    color:#e6fbff;border-radius:12px;padding:10px 14px;font-size:14px;cursor:pointer}
  .btn.primary{background:linear-gradient(90deg,var(--accent),var(--sky));border:none;color:#072133}
  .hint{font-size:12px;color:#9edff0}
  .status{margin-top:10px;font-size:13px}
  .status.ok{color:var(--ok)} .status.err{color:var(--err)}
  .panel{
    background:linear-gradient(180deg,#0b162e,#0b1429);
    border:1px solid rgba(91,215,242,.22); border-radius:14px; padding:12px
  }
  .mute{color:#9fdff0; font-size:13px}
  .kpi{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .pill{display:inline-block;padding:6px 10px;border-radius:999px;font-size:12px;
    border:1px solid rgba(91,215,242,.35); background:rgba(91,215,242,.12); color:#c7f7ff}
</style>
</head>
<body>
<div class="grid-bg"></div>
<div class="wrap">
  <section class="card">
    <!-- Header -->
    <div class="head">
      <div class="brand">
        <img alt="Unidad en Acci√≥n" src="https://raw.githubusercontent.com/ChronosBVRX/InnovacionSindical/main/Logo%20Unidad%20en%20Accion.png">
        <div>
          <h1>Unidad en Acci√≥n</h1>
          <small>Acceso a miembros</small>
        </div>
      </div>
      <a class="back" href="https://chronosbvrx.github.io/InnovacionSindical/">‚Üê Volver al inicio</a>
    </div>

    <!-- Body -->
    <div class="body">
      <!-- Col izquierda: formularios -->
      <div class="col left">
        <div class="tabs">
          <button id="tabLogin" class="tab active" type="button">Entrar</button>
          <button id="tabSignup" class="tab" type="button">Crear cuenta</button>
        </div>

        <!-- Login -->
        <form id="formLogin" autocomplete="on">
          <div>
            <label for="liEmail">Correo</label>
            <input id="liEmail" type="email" placeholder="tu@correo.com" required>
          </div>
          <div>
            <label for="liPass">Contrase√±a</label>
            <input id="liPass" type="password" placeholder="********" required>
          </div>
          <div class="row">
            <button class="btn primary" type="submit">Entrar</button>
            <span class="hint">¬øNuevo? cambia a ‚ÄúCrear cuenta‚Äù.</span>
          </div>
          <div id="liStatus" class="status"></div>
        </form>

        <!-- Signup -->
        <form id="formSignup" style="display:none" autocomplete="on">
          <div class="panel" style="margin-bottom:10px">
            <span class="mute">Crea tu cuenta con correo y contrase√±a. Te enviaremos un correo de verificaci√≥n.</span>
          </div>
          <div>
            <label for="suEmail">Correo</label>
            <input id="suEmail" type="email" placeholder="tu@correo.com" required>
          </div>
          <div>
            <label for="suPass">Contrase√±a</label>
            <input id="suPass" type="password" placeholder="M√≠nimo 6 caracteres" minlength="6" required>
          </div>
          <div class="row">
            <button class="btn primary" type="submit">Crear cuenta</button>
            <span class="hint">Revisa tu bandeja para confirmar.</span>
          </div>
          <div id="suStatus" class="status"></div>
        </form>
      </div>

      <!-- Col derecha: info/ayuda -->
      <div class="col">
        <div class="panel">
          <p class="mute">Acceso seguro con Supabase.</p>
          <div class="kpi">
            <div>
              <div class="pill">üîê Datos cifrados</div>
            </div>
            <div>
              <div class="pill">üõ°Ô∏è Sesi√≥n protegida</div>
            </div>
          </div>
          <hr style="border:none;height:1px;background:rgba(91,215,242,.18);margin:12px 0">
          <p class="mute">¬øProblemas para entrar? Verifica tu correo y contrase√±a. Si creaste cuenta, primero confirma el correo desde el mensaje que te enviamos.</p>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- Supabase JS v2 -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
(() => {
  // ======= CONFIG: pega tus valores =======
  const SUPABASE_URL = https://axsncdwshdvsysrpikwj.supabase.co;     // <- reemplaza
  const SUPABASE_ANON_KEY = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF4c25jZHdzaGR2c3lzcnBpa3dqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAyMjkwMjQsImV4cCI6MjA3NTgwNTAyNH0.oapcH219puVjaR2DcG7dX51uhwVn530L1hhz8ASv7qs;                // <- reemplaza
  const MEMBERS_URL = "miembros.html"; // ad√≥nde mandamos tras login exitoso

  // ======= Init Supabase =======
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
    auth: { persistSession: true, autoRefreshToken: true, detectSessionInUrl: true }
  });

  // ======= Helpers UI =======
  const $ = s => document.querySelector(s);
  const setMsg = (el, msg, kind='') => {
    el.textContent = msg || "";
    el.className = "status" + (kind ? " " + kind : "");
  };

  // Tabs
  const tabLogin = $('#tabLogin');
  const tabSignup = $('#tabSignup');
  const formLogin = $('#formLogin');
  const formSignup = $('#formSignup');

  tabLogin.addEventListener('click', () => {
    tabLogin.classList.add('active'); tabSignup.classList.remove('active');
    formLogin.style.display = ''; formSignup.style.display = 'none';
    setMsg($('#liStatus'), ""); setMsg($('#suStatus'), "");
  });
  tabSignup.addEventListener('click', () => {
    tabSignup.classList.add('active'); tabLogin.classList.remove('active');
    formSignup.style.display = ''; formLogin.style.display = 'none';
    setMsg($('#liStatus'), ""); setMsg($('#suStatus'), "");
  });

  // Si ya hay sesi√≥n ‚Üí redirige
  supabase.auth.getSession().then(({ data:{ session }}) => {
    if (session) location.href = MEMBERS_URL;
  });

  // ======= Entrar =======
  formLogin.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = $('#liEmail').value.trim();
    const password = $('#liPass').value;
    setMsg($('#liStatus'), 'Validando‚Ä¶');

    const { data, error } = await supabase.auth.signInWithPassword({ email, password });
    if (error) {
      setMsg($('#liStatus'), 'Error: ' + (error.message || 'No se pudo iniciar sesi√≥n'), 'err');
      return;
    }
    setMsg($('#liStatus'), '¬°Bienvenido! Redirigiendo‚Ä¶', 'ok');
    // peque√±a pausa para que el mensaje se vea
    setTimeout(() => location.href = MEMBERS_URL, 600);
  });

  // ======= Crear cuenta =======
  formSignup.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = $('#suEmail').value.trim();
    const password = $('#suPass').value;
    setMsg($('#suStatus'), 'Creando cuenta‚Ä¶');

    const { data, error } = await supabase.auth.signUp({
      email, password,
      options: {
        // URL a donde aterriza el bot√≥n "Confirmar email".
        // D√©jalo en tu login para que al confirmar podamos loguear o informar.
        emailRedirectTo: window.location.href.split('#')[0]
      }
    });

    if (error) {
      setMsg($('#suStatus'), 'Error: ' + (error.message || 'No se pudo crear la cuenta'), 'err');
      return;
    }
    setMsg($('#suStatus'),
      'Cuenta creada. Revisa tu correo y confirma para poder iniciar sesi√≥n.',
      'ok'
    );
    // opcional: cambia a la pesta√±a "Entrar"
    tabLogin.click();
  });

  // Si viene de confirmaci√≥n por hash en URL, intenta leer sesi√≥n
  window.addEventListener('hashchange', async () => {
    const { data:{ session } } = await supabase.auth.getSession();
    if (session) location.href = MEMBERS_URL;
  });
})();
</script>
</body>
</html>
